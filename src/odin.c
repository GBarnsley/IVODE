// Automatically generated by odin 1.5.9 - do not edit
#include <float.h>
#include <R.h>
#include <Rmath.h>
#include <Rinternals.h>
#include <stdbool.h>
#include <R_ext/Rdynload.h>
#ifndef CINTERPOLTE_CINTERPOLATE_H_
#define CINTERPOLTE_CINTERPOLATE_H_

// Allow use from C++
#ifdef __cplusplus
extern "C" {
#endif

// There are only three functions in the interface; allocation,
// evaluation and freeing.

// Allocate an interpolation object.
//
//   type: The mode of interpolation. Must be one of "constant",
//       "linear" or "spline" (an R error is thrown if a different
//       value is given).
//
//   n: The number of `x` points to interpolate over
//
//   ny: the number of `y` points per `x` point.  This is 1 in the
//       case of zimple interpolation as used by Rs `interpolate()`
//
//   x: an array of `x` values of length `n`
//
//   y: an array of `ny` sets of `y` values.  This is in R's matrix
//       order (i.e., the first `n` values are the first series to
//       interpolate over).
//
//   fail_on_extrapolate: if true, when an extrapolation occurs throw
//       an error; if false return NA_REAL
//
//   auto_free: automatically clean up the interpolation object on
//       return to R. This uses `R_alloc` for allocations rather than
//       `Calloc` so freeing will always happen (even on error
//       elsewhere in the code). However, this prevents returning back
//       a pointer to R that will last longer than the call into C
//       code.
//
// The return value is an opaque pointer that can be passed through to
// `cinterpolate_eval` and `cinterpolate_free`
void *cinterpolate_alloc(const char *type, size_t n, size_t ny,
                         double *x, double *y, bool fail_on_extrapolate,
                         bool auto_free);

// Evaluate the interpolated function at a new `x` point.
//
//   x: A new, single, `x` point to interpolate `y` values to
//
//   obj: The interpolation object, as returned by `cinterpolate_alloc`
//
//   y: An array of length `ny` to store the interpolated values
//
// The return value is 0 if the interpolation is successful (with x
// lying within the range of values that the interpolation function
// supports), -1 otherwise
int cinterpolate_eval(double x, void *obj, double *y);

// Clean up all allocated memory
//
//   obj: The interpolation object, as returned by `cinterpolate_alloc`
void cinterpolate_free(void *obj);

#ifdef __cplusplus
}
#endif

#endif
typedef struct dynamic_model_internal {
  int age_group_loses_maternal;
  int age_group_no_maternal;
  double *age_rate;
  double *ageing_E;
  double *ageing_I;
  double *ageing_M;
  double *ageing_R;
  double *ageing_S;
  double *ageing_V;
  double *ageing_VD;
  double *ages_up_E;
  double *ages_up_I;
  double *ages_up_M;
  double *ages_up_M_nv;
  double *ages_up_M_v;
  double *ages_up_R;
  double *ages_up_R_nv;
  double *ages_up_R_v;
  double *ages_up_S;
  double *ages_up_S_nv;
  double *ages_up_S_pv;
  double *ages_up_S_v;
  double *ages_up_V;
  double *ages_up_VD;
  double *ages_up_VD_nv;
  double *ages_up_VD_v;
  double *becomes_infectious;
  double *becomes_pre_infectious;
  double *births_deaths_E;
  double *births_deaths_I;
  double *births_deaths_M;
  double *births_deaths_R;
  double *births_deaths_S;
  double *births_deaths_V;
  double *births_deaths_VD;
  double *child_bearing;
  double *crude_birth_rate;
  double *crude_death_rate;
  int dim_age_rate;
  int dim_ageing_E;
  int dim_ageing_I;
  int dim_ageing_M;
  int dim_ageing_R;
  int dim_ageing_S;
  int dim_ageing_V;
  int dim_ageing_VD;
  int dim_ages_up_E;
  int dim_ages_up_I;
  int dim_ages_up_M;
  int dim_ages_up_M_nv;
  int dim_ages_up_M_v;
  int dim_ages_up_R;
  int dim_ages_up_R_nv;
  int dim_ages_up_R_v;
  int dim_ages_up_S;
  int dim_ages_up_S_nv;
  int dim_ages_up_S_pv;
  int dim_ages_up_S_v;
  int dim_ages_up_V;
  int dim_ages_up_VD;
  int dim_ages_up_VD_nv;
  int dim_ages_up_VD_v;
  int dim_becomes_infectious;
  int dim_becomes_pre_infectious;
  int dim_births_deaths_E;
  int dim_births_deaths_I;
  int dim_births_deaths_M;
  int dim_births_deaths_R;
  int dim_births_deaths_S;
  int dim_births_deaths_V;
  int dim_births_deaths_VD;
  int dim_child_bearing;
  int dim_crude_birth_rate;
  int dim_crude_death_rate;
  int dim_E;
  int dim_gains_immunity;
  int dim_I;
  int dim_I_0;
  int dim_infections_S;
  int dim_infections_VD;
  int dim_loses_immunity;
  int dim_M;
  int dim_M_0;
  int dim_prop_death;
  int dim_R;
  int dim_R_0;
  int dim_R0;
  int dim_S;
  int dim_S_0;
  int dim_susceptible_child_bearing;
  int dim_susceptible_pop;
  int dim_t_death_rate;
  int dim_t_vaccination_coverage;
  int dim_t_vaccination_partial_coverage;
  int dim_total_child_bearing;
  int dim_total_pop;
  int dim_tt_crude_birth_rate;
  int dim_tt_crude_death_rate;
  int dim_tt_R0;
  int dim_tt_vaccination_coverage;
  int dim_V;
  int dim_vaccination_coverage;
  int dim_vaccination_coverage_1;
  int dim_vaccination_coverage_2;
  int dim_vaccination_partial_coverage;
  int dim_vaccination_partial_coverage_1;
  int dim_vaccination_partial_coverage_2;
  int dim_VD;
  int dim_waning_R;
  int dim_waning_V;
  int dim_waning_VD;
  int dim_weighted_totals;
  double *gains_immunity;
  double *I_0;
  double *infections_S;
  double *infections_VD;
  double infectious_transition_rate;
  double *initial_E;
  double *initial_I;
  double *initial_M;
  double *initial_R;
  double *initial_S;
  double *initial_V;
  double *initial_VD;
  void *interpolate_t_crude_birth_rate;
  void *interpolate_t_crude_death_rate;
  void *interpolate_t_R0;
  void *interpolate_t_vaccination_coverage;
  void *interpolate_t_vaccination_partial_coverage;
  double *loses_immunity;
  double *M_0;
  int n_age;
  int n_age_penultimate;
  int n_maternal;
  int offset_variable_I;
  int offset_variable_M;
  int offset_variable_R;
  int offset_variable_V;
  int offset_variable_VD;
  double pre_infectious_transition_rate;
  double *prop_death;
  double *R_0;
  double *R0;
  double *S_0;
  double *susceptible_child_bearing;
  double *susceptible_pop;
  double *t_death_rate;
  double *t_vaccination_coverage;
  double *t_vaccination_partial_coverage;
  double *total_child_bearing;
  double *total_pop;
  double *tt_crude_birth_rate;
  double *tt_crude_death_rate;
  double *tt_R0;
  double *tt_vaccination_coverage;
  double *vaccination_coverage;
  double *vaccination_partial_coverage;
  double waning;
  double *waning_R;
  double *waning_V;
  double *waning_VD;
  double *weighted_totals;
} dynamic_model_internal;
typedef struct static_model_internal {
  double adjust_for_crude_foi;
  int age_group_loses_maternal;
  int age_group_no_maternal;
  double *age_rate;
  double *ageing_M;
  double *ageing_R;
  double *ageing_S;
  double *ageing_V;
  double *ageing_VD;
  double *ages_up_M;
  double *ages_up_M_nv;
  double *ages_up_M_v;
  double *ages_up_R;
  double *ages_up_R_nv;
  double *ages_up_R_v;
  double *ages_up_S;
  double *ages_up_S_nv;
  double *ages_up_S_pv;
  double *ages_up_S_v;
  double *ages_up_V;
  double *ages_up_VD;
  double *ages_up_VD_nv;
  double *ages_up_VD_v;
  double *births_deaths_M;
  double *births_deaths_R;
  double *births_deaths_S;
  double *births_deaths_V;
  double *births_deaths_VD;
  double *child_bearing;
  double *crude_birth_rate;
  double *crude_death_rate;
  double *crude_foi;
  int dim_age_rate;
  int dim_ageing_M;
  int dim_ageing_R;
  int dim_ageing_S;
  int dim_ageing_V;
  int dim_ageing_VD;
  int dim_ages_up_M;
  int dim_ages_up_M_nv;
  int dim_ages_up_M_v;
  int dim_ages_up_R;
  int dim_ages_up_R_nv;
  int dim_ages_up_R_v;
  int dim_ages_up_S;
  int dim_ages_up_S_nv;
  int dim_ages_up_S_pv;
  int dim_ages_up_S_v;
  int dim_ages_up_V;
  int dim_ages_up_VD;
  int dim_ages_up_VD_nv;
  int dim_ages_up_VD_v;
  int dim_births_deaths_M;
  int dim_births_deaths_R;
  int dim_births_deaths_S;
  int dim_births_deaths_V;
  int dim_births_deaths_VD;
  int dim_child_bearing;
  int dim_crude_birth_rate;
  int dim_crude_death_rate;
  int dim_crude_foi;
  int dim_gains_immunity;
  int dim_infections_S;
  int dim_infections_VD;
  int dim_loses_immunity;
  int dim_M;
  int dim_M_0;
  int dim_prop_death;
  int dim_R;
  int dim_R_0;
  int dim_S;
  int dim_S_0;
  int dim_susceptible_child_bearing;
  int dim_susceptible_pop;
  int dim_t_death_rate;
  int dim_t_vaccination_coverage;
  int dim_t_vaccination_partial_coverage;
  int dim_total_child_bearing;
  int dim_total_pop;
  int dim_tt_crude_birth_rate;
  int dim_tt_crude_death_rate;
  int dim_tt_crude_foi;
  int dim_tt_vaccination_coverage;
  int dim_V;
  int dim_vaccination_coverage;
  int dim_vaccination_coverage_1;
  int dim_vaccination_coverage_2;
  int dim_vaccination_partial_coverage;
  int dim_vaccination_partial_coverage_1;
  int dim_vaccination_partial_coverage_2;
  int dim_VD;
  int dim_waning_R;
  int dim_waning_V;
  int dim_waning_VD;
  int dim_weighted_totals;
  double *gains_immunity;
  double *infections_S;
  double *infections_VD;
  double *initial_M;
  double *initial_R;
  double *initial_S;
  double *initial_V;
  double *initial_VD;
  void *interpolate_t_crude_birth_rate;
  void *interpolate_t_crude_death_rate;
  void *interpolate_t_crude_foi;
  void *interpolate_t_vaccination_coverage;
  void *interpolate_t_vaccination_partial_coverage;
  double *loses_immunity;
  double *M_0;
  int n_age;
  int n_age_penultimate;
  int n_maternal;
  int offset_variable_M;
  int offset_variable_V;
  int offset_variable_VD;
  double *prop_death;
  double *R_0;
  double *S_0;
  double *susceptible_child_bearing;
  double *susceptible_pop;
  double *t_death_rate;
  double *t_vaccination_coverage;
  double *t_vaccination_partial_coverage;
  double *total_child_bearing;
  double *total_pop;
  double *tt_crude_birth_rate;
  double *tt_crude_death_rate;
  double *tt_crude_foi;
  double *tt_vaccination_coverage;
  double *vaccination_coverage;
  double *vaccination_partial_coverage;
  double waning;
  double *waning_R;
  double *waning_V;
  double *waning_VD;
  double *weighted_totals;
} static_model_internal;
dynamic_model_internal* dynamic_model_get_internal(SEXP internal_p, int closed_error);
static void dynamic_model_finalise(SEXP internal_p);
SEXP dynamic_model_create(SEXP user);
void dynamic_model_initmod_desolve(void(* odeparms) (int *, double *));
SEXP dynamic_model_contents(SEXP internal_p);
SEXP dynamic_model_set_user(SEXP internal_p, SEXP user);
SEXP dynamic_model_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP dynamic_model_use_dde_ptr);
SEXP dynamic_model_metadata(SEXP internal_p);
SEXP dynamic_model_initial_conditions(SEXP internal_p, SEXP t_ptr);
void dynamic_model_rhs(dynamic_model_internal* internal, double t, double * state, double * dstatedt, double * output);
void dynamic_model_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void dynamic_model_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
SEXP dynamic_model_rhs_r(SEXP internal_p, SEXP t, SEXP state);
static_model_internal* static_model_get_internal(SEXP internal_p, int closed_error);
static void static_model_finalise(SEXP internal_p);
SEXP static_model_create(SEXP user);
void static_model_initmod_desolve(void(* odeparms) (int *, double *));
SEXP static_model_contents(SEXP internal_p);
SEXP static_model_set_user(SEXP internal_p, SEXP user);
SEXP static_model_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP static_model_use_dde_ptr);
SEXP static_model_metadata(SEXP internal_p);
SEXP static_model_initial_conditions(SEXP internal_p, SEXP t_ptr);
void static_model_rhs(static_model_internal* internal, double t, double * state, double * dstatedt, double * output);
void static_model_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void static_model_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
SEXP static_model_rhs_r(SEXP internal_p, SEXP t, SEXP state);
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max);
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max);
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name);
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name);
void user_check_values(SEXP value, double min, double max,
                           const char *name);
SEXP user_list_element(SEXP list, const char *name);
void odin_set_dim(SEXP target, int rank, ...);
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim);
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...);
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max);
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required);
void interpolate_check_y(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target);
double scalar_real(SEXP x, const char * name);
double odin_sum1(double *x, size_t from, size_t to);
double odin_sum2(double* x, int from_i, int to_i, int from_j, int to_j, int dim_x_1);
dynamic_model_internal* dynamic_model_get_internal(SEXP internal_p, int closed_error) {
  dynamic_model_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (dynamic_model_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void dynamic_model_finalise(SEXP internal_p) {
  dynamic_model_internal *internal = dynamic_model_get_internal(internal_p, 0);
  if (internal_p) {
    cinterpolate_free(internal->interpolate_t_crude_birth_rate);
    cinterpolate_free(internal->interpolate_t_crude_death_rate);
    cinterpolate_free(internal->interpolate_t_R0);
    cinterpolate_free(internal->interpolate_t_vaccination_coverage);
    cinterpolate_free(internal->interpolate_t_vaccination_partial_coverage);
    internal->interpolate_t_crude_birth_rate = NULL;
    internal->interpolate_t_crude_death_rate = NULL;
    internal->interpolate_t_R0 = NULL;
    internal->interpolate_t_vaccination_coverage = NULL;
    internal->interpolate_t_vaccination_partial_coverage = NULL;
    R_Free(internal->age_rate);
    R_Free(internal->ageing_E);
    R_Free(internal->ageing_I);
    R_Free(internal->ageing_M);
    R_Free(internal->ageing_R);
    R_Free(internal->ageing_S);
    R_Free(internal->ageing_V);
    R_Free(internal->ageing_VD);
    R_Free(internal->ages_up_E);
    R_Free(internal->ages_up_I);
    R_Free(internal->ages_up_M);
    R_Free(internal->ages_up_M_nv);
    R_Free(internal->ages_up_M_v);
    R_Free(internal->ages_up_R);
    R_Free(internal->ages_up_R_nv);
    R_Free(internal->ages_up_R_v);
    R_Free(internal->ages_up_S);
    R_Free(internal->ages_up_S_nv);
    R_Free(internal->ages_up_S_pv);
    R_Free(internal->ages_up_S_v);
    R_Free(internal->ages_up_V);
    R_Free(internal->ages_up_VD);
    R_Free(internal->ages_up_VD_nv);
    R_Free(internal->ages_up_VD_v);
    R_Free(internal->becomes_infectious);
    R_Free(internal->becomes_pre_infectious);
    R_Free(internal->births_deaths_E);
    R_Free(internal->births_deaths_I);
    R_Free(internal->births_deaths_M);
    R_Free(internal->births_deaths_R);
    R_Free(internal->births_deaths_S);
    R_Free(internal->births_deaths_V);
    R_Free(internal->births_deaths_VD);
    R_Free(internal->child_bearing);
    R_Free(internal->crude_birth_rate);
    R_Free(internal->crude_death_rate);
    R_Free(internal->gains_immunity);
    R_Free(internal->I_0);
    R_Free(internal->infections_S);
    R_Free(internal->infections_VD);
    R_Free(internal->initial_E);
    R_Free(internal->initial_I);
    R_Free(internal->initial_M);
    R_Free(internal->initial_R);
    R_Free(internal->initial_S);
    R_Free(internal->initial_V);
    R_Free(internal->initial_VD);
    R_Free(internal->loses_immunity);
    R_Free(internal->M_0);
    R_Free(internal->prop_death);
    R_Free(internal->R_0);
    R_Free(internal->R0);
    R_Free(internal->S_0);
    R_Free(internal->susceptible_child_bearing);
    R_Free(internal->susceptible_pop);
    R_Free(internal->t_death_rate);
    R_Free(internal->t_vaccination_coverage);
    R_Free(internal->t_vaccination_partial_coverage);
    R_Free(internal->total_child_bearing);
    R_Free(internal->total_pop);
    R_Free(internal->tt_crude_birth_rate);
    R_Free(internal->tt_crude_death_rate);
    R_Free(internal->tt_R0);
    R_Free(internal->tt_vaccination_coverage);
    R_Free(internal->vaccination_coverage);
    R_Free(internal->vaccination_partial_coverage);
    R_Free(internal->waning_R);
    R_Free(internal->waning_V);
    R_Free(internal->waning_VD);
    R_Free(internal->weighted_totals);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP dynamic_model_create(SEXP user) {
  dynamic_model_internal *internal = (dynamic_model_internal*) R_Calloc(1, dynamic_model_internal);
  internal->age_rate = NULL;
  internal->ageing_E = NULL;
  internal->ageing_I = NULL;
  internal->ageing_M = NULL;
  internal->ageing_R = NULL;
  internal->ageing_S = NULL;
  internal->ageing_V = NULL;
  internal->ageing_VD = NULL;
  internal->ages_up_E = NULL;
  internal->ages_up_I = NULL;
  internal->ages_up_M = NULL;
  internal->ages_up_M_nv = NULL;
  internal->ages_up_M_v = NULL;
  internal->ages_up_R = NULL;
  internal->ages_up_R_nv = NULL;
  internal->ages_up_R_v = NULL;
  internal->ages_up_S = NULL;
  internal->ages_up_S_nv = NULL;
  internal->ages_up_S_pv = NULL;
  internal->ages_up_S_v = NULL;
  internal->ages_up_V = NULL;
  internal->ages_up_VD = NULL;
  internal->ages_up_VD_nv = NULL;
  internal->ages_up_VD_v = NULL;
  internal->becomes_infectious = NULL;
  internal->becomes_pre_infectious = NULL;
  internal->births_deaths_E = NULL;
  internal->births_deaths_I = NULL;
  internal->births_deaths_M = NULL;
  internal->births_deaths_R = NULL;
  internal->births_deaths_S = NULL;
  internal->births_deaths_V = NULL;
  internal->births_deaths_VD = NULL;
  internal->child_bearing = NULL;
  internal->crude_birth_rate = NULL;
  internal->crude_death_rate = NULL;
  internal->gains_immunity = NULL;
  internal->I_0 = NULL;
  internal->infections_S = NULL;
  internal->infections_VD = NULL;
  internal->initial_E = NULL;
  internal->initial_I = NULL;
  internal->initial_M = NULL;
  internal->initial_R = NULL;
  internal->initial_S = NULL;
  internal->initial_V = NULL;
  internal->initial_VD = NULL;
  internal->interpolate_t_vaccination_coverage = NULL;
  internal->interpolate_t_vaccination_partial_coverage = NULL;
  internal->loses_immunity = NULL;
  internal->M_0 = NULL;
  internal->prop_death = NULL;
  internal->R_0 = NULL;
  internal->R0 = NULL;
  internal->S_0 = NULL;
  internal->susceptible_child_bearing = NULL;
  internal->susceptible_pop = NULL;
  internal->t_death_rate = NULL;
  internal->t_vaccination_coverage = NULL;
  internal->t_vaccination_partial_coverage = NULL;
  internal->total_child_bearing = NULL;
  internal->total_pop = NULL;
  internal->tt_crude_birth_rate = NULL;
  internal->tt_crude_death_rate = NULL;
  internal->tt_R0 = NULL;
  internal->tt_vaccination_coverage = NULL;
  internal->vaccination_coverage = NULL;
  internal->vaccination_partial_coverage = NULL;
  internal->waning_R = NULL;
  internal->waning_V = NULL;
  internal->waning_VD = NULL;
  internal->weighted_totals = NULL;
  internal->age_rate = NULL;
  internal->child_bearing = NULL;
  internal->crude_birth_rate = NULL;
  internal->crude_death_rate = NULL;
  internal->I_0 = NULL;
  internal->infectious_transition_rate = NA_REAL;
  internal->M_0 = NULL;
  internal->n_age = NA_INTEGER;
  internal->n_maternal = NA_INTEGER;
  internal->pre_infectious_transition_rate = NA_REAL;
  internal->prop_death = NULL;
  internal->R_0 = NULL;
  internal->R0 = NULL;
  internal->S_0 = NULL;
  internal->tt_crude_birth_rate = NULL;
  internal->tt_crude_death_rate = NULL;
  internal->tt_R0 = NULL;
  internal->tt_vaccination_coverage = NULL;
  internal->vaccination_coverage = NULL;
  internal->vaccination_partial_coverage = NULL;
  internal->waning = NA_REAL;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, dynamic_model_finalise);
  UNPROTECT(1);
  return ptr;
}
static dynamic_model_internal *dynamic_model_internal_ds;
void dynamic_model_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  dynamic_model_internal_ds = dynamic_model_get_internal(get_desolve_gparms(), 1);
}
SEXP dynamic_model_contents(SEXP internal_p) {
  dynamic_model_internal *internal = dynamic_model_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 162));
  SET_VECTOR_ELT(contents, 0, ScalarInteger(internal->age_group_loses_maternal));
  SET_VECTOR_ELT(contents, 1, ScalarInteger(internal->age_group_no_maternal));
  SEXP age_rate = PROTECT(allocVector(REALSXP, internal->dim_age_rate));
  memcpy(REAL(age_rate), internal->age_rate, internal->dim_age_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 2, age_rate);
  SEXP ageing_E = PROTECT(allocVector(REALSXP, internal->dim_ageing_E));
  memcpy(REAL(ageing_E), internal->ageing_E, internal->dim_ageing_E * sizeof(double));
  SET_VECTOR_ELT(contents, 3, ageing_E);
  SEXP ageing_I = PROTECT(allocVector(REALSXP, internal->dim_ageing_I));
  memcpy(REAL(ageing_I), internal->ageing_I, internal->dim_ageing_I * sizeof(double));
  SET_VECTOR_ELT(contents, 4, ageing_I);
  SEXP ageing_M = PROTECT(allocVector(REALSXP, internal->dim_ageing_M));
  memcpy(REAL(ageing_M), internal->ageing_M, internal->dim_ageing_M * sizeof(double));
  SET_VECTOR_ELT(contents, 5, ageing_M);
  SEXP ageing_R = PROTECT(allocVector(REALSXP, internal->dim_ageing_R));
  memcpy(REAL(ageing_R), internal->ageing_R, internal->dim_ageing_R * sizeof(double));
  SET_VECTOR_ELT(contents, 6, ageing_R);
  SEXP ageing_S = PROTECT(allocVector(REALSXP, internal->dim_ageing_S));
  memcpy(REAL(ageing_S), internal->ageing_S, internal->dim_ageing_S * sizeof(double));
  SET_VECTOR_ELT(contents, 7, ageing_S);
  SEXP ageing_V = PROTECT(allocVector(REALSXP, internal->dim_ageing_V));
  memcpy(REAL(ageing_V), internal->ageing_V, internal->dim_ageing_V * sizeof(double));
  SET_VECTOR_ELT(contents, 8, ageing_V);
  SEXP ageing_VD = PROTECT(allocVector(REALSXP, internal->dim_ageing_VD));
  memcpy(REAL(ageing_VD), internal->ageing_VD, internal->dim_ageing_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 9, ageing_VD);
  SEXP ages_up_E = PROTECT(allocVector(REALSXP, internal->dim_ages_up_E));
  memcpy(REAL(ages_up_E), internal->ages_up_E, internal->dim_ages_up_E * sizeof(double));
  SET_VECTOR_ELT(contents, 10, ages_up_E);
  SEXP ages_up_I = PROTECT(allocVector(REALSXP, internal->dim_ages_up_I));
  memcpy(REAL(ages_up_I), internal->ages_up_I, internal->dim_ages_up_I * sizeof(double));
  SET_VECTOR_ELT(contents, 11, ages_up_I);
  SEXP ages_up_M = PROTECT(allocVector(REALSXP, internal->dim_ages_up_M));
  memcpy(REAL(ages_up_M), internal->ages_up_M, internal->dim_ages_up_M * sizeof(double));
  SET_VECTOR_ELT(contents, 12, ages_up_M);
  SEXP ages_up_M_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_M_nv));
  memcpy(REAL(ages_up_M_nv), internal->ages_up_M_nv, internal->dim_ages_up_M_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 13, ages_up_M_nv);
  SEXP ages_up_M_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_M_v));
  memcpy(REAL(ages_up_M_v), internal->ages_up_M_v, internal->dim_ages_up_M_v * sizeof(double));
  SET_VECTOR_ELT(contents, 14, ages_up_M_v);
  SEXP ages_up_R = PROTECT(allocVector(REALSXP, internal->dim_ages_up_R));
  memcpy(REAL(ages_up_R), internal->ages_up_R, internal->dim_ages_up_R * sizeof(double));
  SET_VECTOR_ELT(contents, 15, ages_up_R);
  SEXP ages_up_R_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_R_nv));
  memcpy(REAL(ages_up_R_nv), internal->ages_up_R_nv, internal->dim_ages_up_R_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 16, ages_up_R_nv);
  SEXP ages_up_R_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_R_v));
  memcpy(REAL(ages_up_R_v), internal->ages_up_R_v, internal->dim_ages_up_R_v * sizeof(double));
  SET_VECTOR_ELT(contents, 17, ages_up_R_v);
  SEXP ages_up_S = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S));
  memcpy(REAL(ages_up_S), internal->ages_up_S, internal->dim_ages_up_S * sizeof(double));
  SET_VECTOR_ELT(contents, 18, ages_up_S);
  SEXP ages_up_S_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S_nv));
  memcpy(REAL(ages_up_S_nv), internal->ages_up_S_nv, internal->dim_ages_up_S_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 19, ages_up_S_nv);
  SEXP ages_up_S_pv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S_pv));
  memcpy(REAL(ages_up_S_pv), internal->ages_up_S_pv, internal->dim_ages_up_S_pv * sizeof(double));
  SET_VECTOR_ELT(contents, 20, ages_up_S_pv);
  SEXP ages_up_S_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S_v));
  memcpy(REAL(ages_up_S_v), internal->ages_up_S_v, internal->dim_ages_up_S_v * sizeof(double));
  SET_VECTOR_ELT(contents, 21, ages_up_S_v);
  SEXP ages_up_V = PROTECT(allocVector(REALSXP, internal->dim_ages_up_V));
  memcpy(REAL(ages_up_V), internal->ages_up_V, internal->dim_ages_up_V * sizeof(double));
  SET_VECTOR_ELT(contents, 22, ages_up_V);
  SEXP ages_up_VD = PROTECT(allocVector(REALSXP, internal->dim_ages_up_VD));
  memcpy(REAL(ages_up_VD), internal->ages_up_VD, internal->dim_ages_up_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 23, ages_up_VD);
  SEXP ages_up_VD_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_VD_nv));
  memcpy(REAL(ages_up_VD_nv), internal->ages_up_VD_nv, internal->dim_ages_up_VD_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 24, ages_up_VD_nv);
  SEXP ages_up_VD_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_VD_v));
  memcpy(REAL(ages_up_VD_v), internal->ages_up_VD_v, internal->dim_ages_up_VD_v * sizeof(double));
  SET_VECTOR_ELT(contents, 25, ages_up_VD_v);
  SEXP becomes_infectious = PROTECT(allocVector(REALSXP, internal->dim_becomes_infectious));
  memcpy(REAL(becomes_infectious), internal->becomes_infectious, internal->dim_becomes_infectious * sizeof(double));
  SET_VECTOR_ELT(contents, 26, becomes_infectious);
  SEXP becomes_pre_infectious = PROTECT(allocVector(REALSXP, internal->dim_becomes_pre_infectious));
  memcpy(REAL(becomes_pre_infectious), internal->becomes_pre_infectious, internal->dim_becomes_pre_infectious * sizeof(double));
  SET_VECTOR_ELT(contents, 27, becomes_pre_infectious);
  SEXP births_deaths_E = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_E));
  memcpy(REAL(births_deaths_E), internal->births_deaths_E, internal->dim_births_deaths_E * sizeof(double));
  SET_VECTOR_ELT(contents, 28, births_deaths_E);
  SEXP births_deaths_I = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_I));
  memcpy(REAL(births_deaths_I), internal->births_deaths_I, internal->dim_births_deaths_I * sizeof(double));
  SET_VECTOR_ELT(contents, 29, births_deaths_I);
  SEXP births_deaths_M = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_M));
  memcpy(REAL(births_deaths_M), internal->births_deaths_M, internal->dim_births_deaths_M * sizeof(double));
  SET_VECTOR_ELT(contents, 30, births_deaths_M);
  SEXP births_deaths_R = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_R));
  memcpy(REAL(births_deaths_R), internal->births_deaths_R, internal->dim_births_deaths_R * sizeof(double));
  SET_VECTOR_ELT(contents, 31, births_deaths_R);
  SEXP births_deaths_S = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_S));
  memcpy(REAL(births_deaths_S), internal->births_deaths_S, internal->dim_births_deaths_S * sizeof(double));
  SET_VECTOR_ELT(contents, 32, births_deaths_S);
  SEXP births_deaths_V = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_V));
  memcpy(REAL(births_deaths_V), internal->births_deaths_V, internal->dim_births_deaths_V * sizeof(double));
  SET_VECTOR_ELT(contents, 33, births_deaths_V);
  SEXP births_deaths_VD = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_VD));
  memcpy(REAL(births_deaths_VD), internal->births_deaths_VD, internal->dim_births_deaths_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 34, births_deaths_VD);
  SEXP child_bearing = PROTECT(allocVector(REALSXP, internal->dim_child_bearing));
  memcpy(REAL(child_bearing), internal->child_bearing, internal->dim_child_bearing * sizeof(double));
  SET_VECTOR_ELT(contents, 35, child_bearing);
  SEXP crude_birth_rate = PROTECT(allocVector(REALSXP, internal->dim_crude_birth_rate));
  memcpy(REAL(crude_birth_rate), internal->crude_birth_rate, internal->dim_crude_birth_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 36, crude_birth_rate);
  SEXP crude_death_rate = PROTECT(allocVector(REALSXP, internal->dim_crude_death_rate));
  memcpy(REAL(crude_death_rate), internal->crude_death_rate, internal->dim_crude_death_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 37, crude_death_rate);
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_age_rate));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_ageing_E));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_ageing_I));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_ageing_M));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_ageing_R));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_ageing_S));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_ageing_V));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_ageing_VD));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_ages_up_E));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_ages_up_I));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_ages_up_M));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_ages_up_M_nv));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_ages_up_M_v));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_ages_up_R));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_ages_up_R_nv));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_ages_up_R_v));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_ages_up_S));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_ages_up_S_nv));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_ages_up_S_pv));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_ages_up_S_v));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_ages_up_V));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_ages_up_VD));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_ages_up_VD_nv));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_ages_up_VD_v));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_becomes_infectious));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_becomes_pre_infectious));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_births_deaths_E));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_births_deaths_I));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_births_deaths_M));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_births_deaths_R));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_births_deaths_S));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_births_deaths_V));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_births_deaths_VD));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_child_bearing));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_crude_birth_rate));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_crude_death_rate));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_E));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_gains_immunity));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_I_0));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_infections_S));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_infections_VD));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_loses_immunity));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_M));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_M_0));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_prop_death));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_R));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_R_0));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_R0));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_S_0));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_susceptible_child_bearing));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_susceptible_pop));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_t_death_rate));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_t_vaccination_coverage));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_t_vaccination_partial_coverage));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_total_child_bearing));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_total_pop));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_tt_crude_birth_rate));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_tt_crude_death_rate));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_tt_R0));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_tt_vaccination_coverage));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_V));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_vaccination_coverage));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_vaccination_coverage_1));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_vaccination_coverage_2));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_vaccination_partial_coverage));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_vaccination_partial_coverage_1));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_vaccination_partial_coverage_2));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_VD));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_waning_R));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_waning_V));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_waning_VD));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_weighted_totals));
  SEXP gains_immunity = PROTECT(allocVector(REALSXP, internal->dim_gains_immunity));
  memcpy(REAL(gains_immunity), internal->gains_immunity, internal->dim_gains_immunity * sizeof(double));
  SET_VECTOR_ELT(contents, 112, gains_immunity);
  SEXP I_0 = PROTECT(allocVector(REALSXP, internal->dim_I_0));
  memcpy(REAL(I_0), internal->I_0, internal->dim_I_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 113, I_0);
  SEXP infections_S = PROTECT(allocVector(REALSXP, internal->dim_infections_S));
  memcpy(REAL(infections_S), internal->infections_S, internal->dim_infections_S * sizeof(double));
  SET_VECTOR_ELT(contents, 114, infections_S);
  SEXP infections_VD = PROTECT(allocVector(REALSXP, internal->dim_infections_VD));
  memcpy(REAL(infections_VD), internal->infections_VD, internal->dim_infections_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 115, infections_VD);
  SET_VECTOR_ELT(contents, 116, ScalarReal(internal->infectious_transition_rate));
  SEXP initial_E = PROTECT(allocVector(REALSXP, internal->dim_E));
  memcpy(REAL(initial_E), internal->initial_E, internal->dim_E * sizeof(double));
  SET_VECTOR_ELT(contents, 117, initial_E);
  SEXP initial_I = PROTECT(allocVector(REALSXP, internal->dim_I));
  memcpy(REAL(initial_I), internal->initial_I, internal->dim_I * sizeof(double));
  SET_VECTOR_ELT(contents, 118, initial_I);
  SEXP initial_M = PROTECT(allocVector(REALSXP, internal->dim_M));
  memcpy(REAL(initial_M), internal->initial_M, internal->dim_M * sizeof(double));
  SET_VECTOR_ELT(contents, 119, initial_M);
  SEXP initial_R = PROTECT(allocVector(REALSXP, internal->dim_R));
  memcpy(REAL(initial_R), internal->initial_R, internal->dim_R * sizeof(double));
  SET_VECTOR_ELT(contents, 120, initial_R);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  SET_VECTOR_ELT(contents, 121, initial_S);
  SEXP initial_V = PROTECT(allocVector(REALSXP, internal->dim_V));
  memcpy(REAL(initial_V), internal->initial_V, internal->dim_V * sizeof(double));
  SET_VECTOR_ELT(contents, 122, initial_V);
  SEXP initial_VD = PROTECT(allocVector(REALSXP, internal->dim_VD));
  memcpy(REAL(initial_VD), internal->initial_VD, internal->dim_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 123, initial_VD);
  SEXP loses_immunity = PROTECT(allocVector(REALSXP, internal->dim_loses_immunity));
  memcpy(REAL(loses_immunity), internal->loses_immunity, internal->dim_loses_immunity * sizeof(double));
  SET_VECTOR_ELT(contents, 129, loses_immunity);
  SEXP M_0 = PROTECT(allocVector(REALSXP, internal->dim_M_0));
  memcpy(REAL(M_0), internal->M_0, internal->dim_M_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 130, M_0);
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->n_age));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->n_age_penultimate));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->n_maternal));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->offset_variable_I));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->offset_variable_M));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->offset_variable_R));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->offset_variable_V));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->offset_variable_VD));
  SET_VECTOR_ELT(contents, 139, ScalarReal(internal->pre_infectious_transition_rate));
  SEXP prop_death = PROTECT(allocVector(REALSXP, internal->dim_prop_death));
  memcpy(REAL(prop_death), internal->prop_death, internal->dim_prop_death * sizeof(double));
  SET_VECTOR_ELT(contents, 140, prop_death);
  SEXP R_0 = PROTECT(allocVector(REALSXP, internal->dim_R_0));
  memcpy(REAL(R_0), internal->R_0, internal->dim_R_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 141, R_0);
  SEXP R0 = PROTECT(allocVector(REALSXP, internal->dim_R0));
  memcpy(REAL(R0), internal->R0, internal->dim_R0 * sizeof(double));
  SET_VECTOR_ELT(contents, 142, R0);
  SEXP S_0 = PROTECT(allocVector(REALSXP, internal->dim_S_0));
  memcpy(REAL(S_0), internal->S_0, internal->dim_S_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 143, S_0);
  SEXP susceptible_child_bearing = PROTECT(allocVector(REALSXP, internal->dim_susceptible_child_bearing));
  memcpy(REAL(susceptible_child_bearing), internal->susceptible_child_bearing, internal->dim_susceptible_child_bearing * sizeof(double));
  SET_VECTOR_ELT(contents, 144, susceptible_child_bearing);
  SEXP susceptible_pop = PROTECT(allocVector(REALSXP, internal->dim_susceptible_pop));
  memcpy(REAL(susceptible_pop), internal->susceptible_pop, internal->dim_susceptible_pop * sizeof(double));
  SET_VECTOR_ELT(contents, 145, susceptible_pop);
  SEXP t_death_rate = PROTECT(allocVector(REALSXP, internal->dim_t_death_rate));
  memcpy(REAL(t_death_rate), internal->t_death_rate, internal->dim_t_death_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 146, t_death_rate);
  SEXP t_vaccination_coverage = PROTECT(allocVector(REALSXP, internal->dim_t_vaccination_coverage));
  memcpy(REAL(t_vaccination_coverage), internal->t_vaccination_coverage, internal->dim_t_vaccination_coverage * sizeof(double));
  SET_VECTOR_ELT(contents, 147, t_vaccination_coverage);
  SEXP t_vaccination_partial_coverage = PROTECT(allocVector(REALSXP, internal->dim_t_vaccination_partial_coverage));
  memcpy(REAL(t_vaccination_partial_coverage), internal->t_vaccination_partial_coverage, internal->dim_t_vaccination_partial_coverage * sizeof(double));
  SET_VECTOR_ELT(contents, 148, t_vaccination_partial_coverage);
  SEXP total_child_bearing = PROTECT(allocVector(REALSXP, internal->dim_total_child_bearing));
  memcpy(REAL(total_child_bearing), internal->total_child_bearing, internal->dim_total_child_bearing * sizeof(double));
  SET_VECTOR_ELT(contents, 149, total_child_bearing);
  SEXP total_pop = PROTECT(allocVector(REALSXP, internal->dim_total_pop));
  memcpy(REAL(total_pop), internal->total_pop, internal->dim_total_pop * sizeof(double));
  SET_VECTOR_ELT(contents, 150, total_pop);
  SEXP tt_crude_birth_rate = PROTECT(allocVector(REALSXP, internal->dim_tt_crude_birth_rate));
  memcpy(REAL(tt_crude_birth_rate), internal->tt_crude_birth_rate, internal->dim_tt_crude_birth_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 151, tt_crude_birth_rate);
  SEXP tt_crude_death_rate = PROTECT(allocVector(REALSXP, internal->dim_tt_crude_death_rate));
  memcpy(REAL(tt_crude_death_rate), internal->tt_crude_death_rate, internal->dim_tt_crude_death_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 152, tt_crude_death_rate);
  SEXP tt_R0 = PROTECT(allocVector(REALSXP, internal->dim_tt_R0));
  memcpy(REAL(tt_R0), internal->tt_R0, internal->dim_tt_R0 * sizeof(double));
  SET_VECTOR_ELT(contents, 153, tt_R0);
  SEXP tt_vaccination_coverage = PROTECT(allocVector(REALSXP, internal->dim_tt_vaccination_coverage));
  memcpy(REAL(tt_vaccination_coverage), internal->tt_vaccination_coverage, internal->dim_tt_vaccination_coverage * sizeof(double));
  SET_VECTOR_ELT(contents, 154, tt_vaccination_coverage);
  SEXP vaccination_coverage = PROTECT(allocVector(REALSXP, internal->dim_vaccination_coverage));
  memcpy(REAL(vaccination_coverage), internal->vaccination_coverage, internal->dim_vaccination_coverage * sizeof(double));
  odin_set_dim(vaccination_coverage, 2, internal->dim_vaccination_coverage_1, internal->dim_vaccination_coverage_2);
  SET_VECTOR_ELT(contents, 155, vaccination_coverage);
  SEXP vaccination_partial_coverage = PROTECT(allocVector(REALSXP, internal->dim_vaccination_partial_coverage));
  memcpy(REAL(vaccination_partial_coverage), internal->vaccination_partial_coverage, internal->dim_vaccination_partial_coverage * sizeof(double));
  odin_set_dim(vaccination_partial_coverage, 2, internal->dim_vaccination_partial_coverage_1, internal->dim_vaccination_partial_coverage_2);
  SET_VECTOR_ELT(contents, 156, vaccination_partial_coverage);
  SET_VECTOR_ELT(contents, 157, ScalarReal(internal->waning));
  SEXP waning_R = PROTECT(allocVector(REALSXP, internal->dim_waning_R));
  memcpy(REAL(waning_R), internal->waning_R, internal->dim_waning_R * sizeof(double));
  SET_VECTOR_ELT(contents, 158, waning_R);
  SEXP waning_V = PROTECT(allocVector(REALSXP, internal->dim_waning_V));
  memcpy(REAL(waning_V), internal->waning_V, internal->dim_waning_V * sizeof(double));
  SET_VECTOR_ELT(contents, 159, waning_V);
  SEXP waning_VD = PROTECT(allocVector(REALSXP, internal->dim_waning_VD));
  memcpy(REAL(waning_VD), internal->waning_VD, internal->dim_waning_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 160, waning_VD);
  SEXP weighted_totals = PROTECT(allocVector(REALSXP, internal->dim_weighted_totals));
  memcpy(REAL(weighted_totals), internal->weighted_totals, internal->dim_weighted_totals * sizeof(double));
  SET_VECTOR_ELT(contents, 161, weighted_totals);
  SEXP nms = PROTECT(allocVector(STRSXP, 162));
  SET_STRING_ELT(nms, 0, mkChar("age_group_loses_maternal"));
  SET_STRING_ELT(nms, 1, mkChar("age_group_no_maternal"));
  SET_STRING_ELT(nms, 2, mkChar("age_rate"));
  SET_STRING_ELT(nms, 3, mkChar("ageing_E"));
  SET_STRING_ELT(nms, 4, mkChar("ageing_I"));
  SET_STRING_ELT(nms, 5, mkChar("ageing_M"));
  SET_STRING_ELT(nms, 6, mkChar("ageing_R"));
  SET_STRING_ELT(nms, 7, mkChar("ageing_S"));
  SET_STRING_ELT(nms, 8, mkChar("ageing_V"));
  SET_STRING_ELT(nms, 9, mkChar("ageing_VD"));
  SET_STRING_ELT(nms, 10, mkChar("ages_up_E"));
  SET_STRING_ELT(nms, 11, mkChar("ages_up_I"));
  SET_STRING_ELT(nms, 12, mkChar("ages_up_M"));
  SET_STRING_ELT(nms, 13, mkChar("ages_up_M_nv"));
  SET_STRING_ELT(nms, 14, mkChar("ages_up_M_v"));
  SET_STRING_ELT(nms, 15, mkChar("ages_up_R"));
  SET_STRING_ELT(nms, 16, mkChar("ages_up_R_nv"));
  SET_STRING_ELT(nms, 17, mkChar("ages_up_R_v"));
  SET_STRING_ELT(nms, 18, mkChar("ages_up_S"));
  SET_STRING_ELT(nms, 19, mkChar("ages_up_S_nv"));
  SET_STRING_ELT(nms, 20, mkChar("ages_up_S_pv"));
  SET_STRING_ELT(nms, 21, mkChar("ages_up_S_v"));
  SET_STRING_ELT(nms, 22, mkChar("ages_up_V"));
  SET_STRING_ELT(nms, 23, mkChar("ages_up_VD"));
  SET_STRING_ELT(nms, 24, mkChar("ages_up_VD_nv"));
  SET_STRING_ELT(nms, 25, mkChar("ages_up_VD_v"));
  SET_STRING_ELT(nms, 26, mkChar("becomes_infectious"));
  SET_STRING_ELT(nms, 27, mkChar("becomes_pre_infectious"));
  SET_STRING_ELT(nms, 28, mkChar("births_deaths_E"));
  SET_STRING_ELT(nms, 29, mkChar("births_deaths_I"));
  SET_STRING_ELT(nms, 30, mkChar("births_deaths_M"));
  SET_STRING_ELT(nms, 31, mkChar("births_deaths_R"));
  SET_STRING_ELT(nms, 32, mkChar("births_deaths_S"));
  SET_STRING_ELT(nms, 33, mkChar("births_deaths_V"));
  SET_STRING_ELT(nms, 34, mkChar("births_deaths_VD"));
  SET_STRING_ELT(nms, 35, mkChar("child_bearing"));
  SET_STRING_ELT(nms, 36, mkChar("crude_birth_rate"));
  SET_STRING_ELT(nms, 37, mkChar("crude_death_rate"));
  SET_STRING_ELT(nms, 38, mkChar("dim_age_rate"));
  SET_STRING_ELT(nms, 39, mkChar("dim_ageing_E"));
  SET_STRING_ELT(nms, 40, mkChar("dim_ageing_I"));
  SET_STRING_ELT(nms, 41, mkChar("dim_ageing_M"));
  SET_STRING_ELT(nms, 42, mkChar("dim_ageing_R"));
  SET_STRING_ELT(nms, 43, mkChar("dim_ageing_S"));
  SET_STRING_ELT(nms, 44, mkChar("dim_ageing_V"));
  SET_STRING_ELT(nms, 45, mkChar("dim_ageing_VD"));
  SET_STRING_ELT(nms, 46, mkChar("dim_ages_up_E"));
  SET_STRING_ELT(nms, 47, mkChar("dim_ages_up_I"));
  SET_STRING_ELT(nms, 48, mkChar("dim_ages_up_M"));
  SET_STRING_ELT(nms, 49, mkChar("dim_ages_up_M_nv"));
  SET_STRING_ELT(nms, 50, mkChar("dim_ages_up_M_v"));
  SET_STRING_ELT(nms, 51, mkChar("dim_ages_up_R"));
  SET_STRING_ELT(nms, 52, mkChar("dim_ages_up_R_nv"));
  SET_STRING_ELT(nms, 53, mkChar("dim_ages_up_R_v"));
  SET_STRING_ELT(nms, 54, mkChar("dim_ages_up_S"));
  SET_STRING_ELT(nms, 55, mkChar("dim_ages_up_S_nv"));
  SET_STRING_ELT(nms, 56, mkChar("dim_ages_up_S_pv"));
  SET_STRING_ELT(nms, 57, mkChar("dim_ages_up_S_v"));
  SET_STRING_ELT(nms, 58, mkChar("dim_ages_up_V"));
  SET_STRING_ELT(nms, 59, mkChar("dim_ages_up_VD"));
  SET_STRING_ELT(nms, 60, mkChar("dim_ages_up_VD_nv"));
  SET_STRING_ELT(nms, 61, mkChar("dim_ages_up_VD_v"));
  SET_STRING_ELT(nms, 62, mkChar("dim_becomes_infectious"));
  SET_STRING_ELT(nms, 63, mkChar("dim_becomes_pre_infectious"));
  SET_STRING_ELT(nms, 64, mkChar("dim_births_deaths_E"));
  SET_STRING_ELT(nms, 65, mkChar("dim_births_deaths_I"));
  SET_STRING_ELT(nms, 66, mkChar("dim_births_deaths_M"));
  SET_STRING_ELT(nms, 67, mkChar("dim_births_deaths_R"));
  SET_STRING_ELT(nms, 68, mkChar("dim_births_deaths_S"));
  SET_STRING_ELT(nms, 69, mkChar("dim_births_deaths_V"));
  SET_STRING_ELT(nms, 70, mkChar("dim_births_deaths_VD"));
  SET_STRING_ELT(nms, 71, mkChar("dim_child_bearing"));
  SET_STRING_ELT(nms, 72, mkChar("dim_crude_birth_rate"));
  SET_STRING_ELT(nms, 73, mkChar("dim_crude_death_rate"));
  SET_STRING_ELT(nms, 74, mkChar("dim_E"));
  SET_STRING_ELT(nms, 75, mkChar("dim_gains_immunity"));
  SET_STRING_ELT(nms, 76, mkChar("dim_I"));
  SET_STRING_ELT(nms, 77, mkChar("dim_I_0"));
  SET_STRING_ELT(nms, 78, mkChar("dim_infections_S"));
  SET_STRING_ELT(nms, 79, mkChar("dim_infections_VD"));
  SET_STRING_ELT(nms, 80, mkChar("dim_loses_immunity"));
  SET_STRING_ELT(nms, 81, mkChar("dim_M"));
  SET_STRING_ELT(nms, 82, mkChar("dim_M_0"));
  SET_STRING_ELT(nms, 83, mkChar("dim_prop_death"));
  SET_STRING_ELT(nms, 84, mkChar("dim_R"));
  SET_STRING_ELT(nms, 85, mkChar("dim_R_0"));
  SET_STRING_ELT(nms, 86, mkChar("dim_R0"));
  SET_STRING_ELT(nms, 87, mkChar("dim_S"));
  SET_STRING_ELT(nms, 88, mkChar("dim_S_0"));
  SET_STRING_ELT(nms, 89, mkChar("dim_susceptible_child_bearing"));
  SET_STRING_ELT(nms, 90, mkChar("dim_susceptible_pop"));
  SET_STRING_ELT(nms, 91, mkChar("dim_t_death_rate"));
  SET_STRING_ELT(nms, 92, mkChar("dim_t_vaccination_coverage"));
  SET_STRING_ELT(nms, 93, mkChar("dim_t_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 94, mkChar("dim_total_child_bearing"));
  SET_STRING_ELT(nms, 95, mkChar("dim_total_pop"));
  SET_STRING_ELT(nms, 96, mkChar("dim_tt_crude_birth_rate"));
  SET_STRING_ELT(nms, 97, mkChar("dim_tt_crude_death_rate"));
  SET_STRING_ELT(nms, 98, mkChar("dim_tt_R0"));
  SET_STRING_ELT(nms, 99, mkChar("dim_tt_vaccination_coverage"));
  SET_STRING_ELT(nms, 100, mkChar("dim_V"));
  SET_STRING_ELT(nms, 101, mkChar("dim_vaccination_coverage"));
  SET_STRING_ELT(nms, 102, mkChar("dim_vaccination_coverage_1"));
  SET_STRING_ELT(nms, 103, mkChar("dim_vaccination_coverage_2"));
  SET_STRING_ELT(nms, 104, mkChar("dim_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 105, mkChar("dim_vaccination_partial_coverage_1"));
  SET_STRING_ELT(nms, 106, mkChar("dim_vaccination_partial_coverage_2"));
  SET_STRING_ELT(nms, 107, mkChar("dim_VD"));
  SET_STRING_ELT(nms, 108, mkChar("dim_waning_R"));
  SET_STRING_ELT(nms, 109, mkChar("dim_waning_V"));
  SET_STRING_ELT(nms, 110, mkChar("dim_waning_VD"));
  SET_STRING_ELT(nms, 111, mkChar("dim_weighted_totals"));
  SET_STRING_ELT(nms, 112, mkChar("gains_immunity"));
  SET_STRING_ELT(nms, 113, mkChar("I_0"));
  SET_STRING_ELT(nms, 114, mkChar("infections_S"));
  SET_STRING_ELT(nms, 115, mkChar("infections_VD"));
  SET_STRING_ELT(nms, 116, mkChar("infectious_transition_rate"));
  SET_STRING_ELT(nms, 117, mkChar("initial_E"));
  SET_STRING_ELT(nms, 118, mkChar("initial_I"));
  SET_STRING_ELT(nms, 119, mkChar("initial_M"));
  SET_STRING_ELT(nms, 120, mkChar("initial_R"));
  SET_STRING_ELT(nms, 121, mkChar("initial_S"));
  SET_STRING_ELT(nms, 122, mkChar("initial_V"));
  SET_STRING_ELT(nms, 123, mkChar("initial_VD"));
  SET_STRING_ELT(nms, 124, mkChar("interpolate_t_crude_birth_rate"));
  SET_STRING_ELT(nms, 125, mkChar("interpolate_t_crude_death_rate"));
  SET_STRING_ELT(nms, 126, mkChar("interpolate_t_R0"));
  SET_STRING_ELT(nms, 127, mkChar("interpolate_t_vaccination_coverage"));
  SET_STRING_ELT(nms, 128, mkChar("interpolate_t_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 129, mkChar("loses_immunity"));
  SET_STRING_ELT(nms, 130, mkChar("M_0"));
  SET_STRING_ELT(nms, 131, mkChar("n_age"));
  SET_STRING_ELT(nms, 132, mkChar("n_age_penultimate"));
  SET_STRING_ELT(nms, 133, mkChar("n_maternal"));
  SET_STRING_ELT(nms, 134, mkChar("offset_variable_I"));
  SET_STRING_ELT(nms, 135, mkChar("offset_variable_M"));
  SET_STRING_ELT(nms, 136, mkChar("offset_variable_R"));
  SET_STRING_ELT(nms, 137, mkChar("offset_variable_V"));
  SET_STRING_ELT(nms, 138, mkChar("offset_variable_VD"));
  SET_STRING_ELT(nms, 139, mkChar("pre_infectious_transition_rate"));
  SET_STRING_ELT(nms, 140, mkChar("prop_death"));
  SET_STRING_ELT(nms, 141, mkChar("R_0"));
  SET_STRING_ELT(nms, 142, mkChar("R0"));
  SET_STRING_ELT(nms, 143, mkChar("S_0"));
  SET_STRING_ELT(nms, 144, mkChar("susceptible_child_bearing"));
  SET_STRING_ELT(nms, 145, mkChar("susceptible_pop"));
  SET_STRING_ELT(nms, 146, mkChar("t_death_rate"));
  SET_STRING_ELT(nms, 147, mkChar("t_vaccination_coverage"));
  SET_STRING_ELT(nms, 148, mkChar("t_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 149, mkChar("total_child_bearing"));
  SET_STRING_ELT(nms, 150, mkChar("total_pop"));
  SET_STRING_ELT(nms, 151, mkChar("tt_crude_birth_rate"));
  SET_STRING_ELT(nms, 152, mkChar("tt_crude_death_rate"));
  SET_STRING_ELT(nms, 153, mkChar("tt_R0"));
  SET_STRING_ELT(nms, 154, mkChar("tt_vaccination_coverage"));
  SET_STRING_ELT(nms, 155, mkChar("vaccination_coverage"));
  SET_STRING_ELT(nms, 156, mkChar("vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 157, mkChar("waning"));
  SET_STRING_ELT(nms, 158, mkChar("waning_R"));
  SET_STRING_ELT(nms, 159, mkChar("waning_V"));
  SET_STRING_ELT(nms, 160, mkChar("waning_VD"));
  SET_STRING_ELT(nms, 161, mkChar("weighted_totals"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(72);
  return contents;
}
SEXP dynamic_model_set_user(SEXP internal_p, SEXP user) {
  dynamic_model_internal *internal = dynamic_model_get_internal(internal_p, 1);
  internal->infectious_transition_rate = user_get_scalar_double(user, "infectious_transition_rate", internal->infectious_transition_rate, NA_REAL, NA_REAL);
  internal->n_age = user_get_scalar_int(user, "n_age", internal->n_age, NA_REAL, NA_REAL);
  internal->n_maternal = user_get_scalar_int(user, "n_maternal", internal->n_maternal, NA_REAL, NA_REAL);
  internal->pre_infectious_transition_rate = user_get_scalar_double(user, "pre_infectious_transition_rate", internal->pre_infectious_transition_rate, NA_REAL, NA_REAL);
  internal->tt_crude_birth_rate = (double*) user_get_array_dim(user, false, internal->tt_crude_birth_rate, "tt_crude_birth_rate", 1, NA_REAL, NA_REAL, &internal->dim_tt_crude_birth_rate);
  internal->tt_crude_death_rate = (double*) user_get_array_dim(user, false, internal->tt_crude_death_rate, "tt_crude_death_rate", 1, NA_REAL, NA_REAL, &internal->dim_tt_crude_death_rate);
  internal->tt_R0 = (double*) user_get_array_dim(user, false, internal->tt_R0, "tt_R0", 1, NA_REAL, NA_REAL, &internal->dim_tt_R0);
  internal->tt_vaccination_coverage = (double*) user_get_array_dim(user, false, internal->tt_vaccination_coverage, "tt_vaccination_coverage", 1, NA_REAL, NA_REAL, &internal->dim_tt_vaccination_coverage);
  internal->waning = user_get_scalar_double(user, "waning", internal->waning, NA_REAL, NA_REAL);
  internal->age_group_loses_maternal = internal->n_maternal + 1;
  internal->dim_age_rate = internal->n_age;
  internal->dim_ageing_E = internal->n_age;
  internal->dim_ageing_I = internal->n_age;
  internal->dim_ageing_M = internal->n_maternal;
  internal->dim_ageing_R = internal->n_age;
  internal->dim_ageing_S = internal->n_age;
  internal->dim_ageing_V = internal->n_age;
  internal->dim_ageing_VD = internal->n_age;
  internal->dim_ages_up_E = internal->n_age;
  internal->dim_ages_up_I = internal->n_age;
  internal->dim_ages_up_M = internal->n_maternal;
  internal->dim_ages_up_M_nv = internal->n_maternal;
  internal->dim_ages_up_M_v = internal->n_maternal;
  internal->dim_ages_up_R = internal->n_age;
  internal->dim_ages_up_R_nv = internal->n_age;
  internal->dim_ages_up_R_v = internal->n_age;
  internal->dim_ages_up_S = internal->n_age;
  internal->dim_ages_up_S_nv = internal->n_age;
  internal->dim_ages_up_S_pv = internal->n_age;
  internal->dim_ages_up_S_v = internal->n_age;
  internal->dim_ages_up_V = internal->n_age;
  internal->dim_ages_up_VD = internal->n_age;
  internal->dim_ages_up_VD_nv = internal->n_age;
  internal->dim_ages_up_VD_v = internal->n_age;
  internal->dim_becomes_infectious = internal->n_age;
  internal->dim_becomes_pre_infectious = internal->n_age;
  internal->dim_births_deaths_E = internal->n_age;
  internal->dim_births_deaths_I = internal->n_age;
  internal->dim_births_deaths_M = internal->n_maternal;
  internal->dim_births_deaths_R = internal->n_age;
  internal->dim_births_deaths_S = internal->n_age;
  internal->dim_births_deaths_V = internal->n_age;
  internal->dim_births_deaths_VD = internal->n_age;
  internal->dim_child_bearing = internal->n_age;
  internal->dim_E = internal->n_age;
  internal->dim_gains_immunity = internal->n_age;
  internal->dim_I = internal->n_age;
  internal->dim_I_0 = internal->n_age;
  internal->dim_infections_S = internal->n_age;
  internal->dim_infections_VD = internal->n_age;
  internal->dim_loses_immunity = internal->n_age;
  internal->dim_M = internal->n_maternal;
  internal->dim_M_0 = internal->n_maternal;
  internal->dim_prop_death = internal->n_age;
  internal->dim_R = internal->n_age;
  internal->dim_R_0 = internal->n_age;
  internal->dim_S = internal->n_age;
  internal->dim_S_0 = internal->n_age;
  internal->dim_susceptible_child_bearing = internal->n_age;
  internal->dim_susceptible_pop = internal->n_age;
  internal->dim_t_death_rate = internal->n_age;
  internal->dim_t_vaccination_coverage = internal->n_age;
  internal->dim_t_vaccination_partial_coverage = internal->n_age;
  internal->dim_total_child_bearing = internal->n_age;
  internal->dim_total_pop = internal->n_age;
  internal->dim_V = internal->n_age;
  internal->dim_VD = internal->n_age;
  internal->dim_waning_R = internal->n_age;
  internal->dim_waning_V = internal->n_age;
  internal->dim_waning_VD = internal->n_age;
  internal->dim_weighted_totals = internal->n_age;
  internal->n_age_penultimate = internal->n_age - 1;
  internal->age_group_no_maternal = internal->age_group_loses_maternal + 1;
  internal->age_rate = (double*) user_get_array(user, false, internal->age_rate, "age_rate", NA_REAL, NA_REAL, 1, internal->dim_age_rate);
  R_Free(internal->ageing_E);
  internal->ageing_E = (double*) R_Calloc(internal->dim_ageing_E, double);
  R_Free(internal->ageing_I);
  internal->ageing_I = (double*) R_Calloc(internal->dim_ageing_I, double);
  R_Free(internal->ageing_M);
  internal->ageing_M = (double*) R_Calloc(internal->dim_ageing_M, double);
  R_Free(internal->ageing_R);
  internal->ageing_R = (double*) R_Calloc(internal->dim_ageing_R, double);
  R_Free(internal->ageing_S);
  internal->ageing_S = (double*) R_Calloc(internal->dim_ageing_S, double);
  R_Free(internal->ageing_V);
  internal->ageing_V = (double*) R_Calloc(internal->dim_ageing_V, double);
  R_Free(internal->ageing_VD);
  internal->ageing_VD = (double*) R_Calloc(internal->dim_ageing_VD, double);
  R_Free(internal->ages_up_E);
  internal->ages_up_E = (double*) R_Calloc(internal->dim_ages_up_E, double);
  R_Free(internal->ages_up_I);
  internal->ages_up_I = (double*) R_Calloc(internal->dim_ages_up_I, double);
  R_Free(internal->ages_up_M);
  internal->ages_up_M = (double*) R_Calloc(internal->dim_ages_up_M, double);
  R_Free(internal->ages_up_M_nv);
  internal->ages_up_M_nv = (double*) R_Calloc(internal->dim_ages_up_M_nv, double);
  R_Free(internal->ages_up_M_v);
  internal->ages_up_M_v = (double*) R_Calloc(internal->dim_ages_up_M_v, double);
  R_Free(internal->ages_up_R);
  internal->ages_up_R = (double*) R_Calloc(internal->dim_ages_up_R, double);
  R_Free(internal->ages_up_R_nv);
  internal->ages_up_R_nv = (double*) R_Calloc(internal->dim_ages_up_R_nv, double);
  R_Free(internal->ages_up_R_v);
  internal->ages_up_R_v = (double*) R_Calloc(internal->dim_ages_up_R_v, double);
  R_Free(internal->ages_up_S);
  internal->ages_up_S = (double*) R_Calloc(internal->dim_ages_up_S, double);
  R_Free(internal->ages_up_S_nv);
  internal->ages_up_S_nv = (double*) R_Calloc(internal->dim_ages_up_S_nv, double);
  R_Free(internal->ages_up_S_pv);
  internal->ages_up_S_pv = (double*) R_Calloc(internal->dim_ages_up_S_pv, double);
  R_Free(internal->ages_up_S_v);
  internal->ages_up_S_v = (double*) R_Calloc(internal->dim_ages_up_S_v, double);
  R_Free(internal->ages_up_V);
  internal->ages_up_V = (double*) R_Calloc(internal->dim_ages_up_V, double);
  R_Free(internal->ages_up_VD);
  internal->ages_up_VD = (double*) R_Calloc(internal->dim_ages_up_VD, double);
  R_Free(internal->ages_up_VD_nv);
  internal->ages_up_VD_nv = (double*) R_Calloc(internal->dim_ages_up_VD_nv, double);
  R_Free(internal->ages_up_VD_v);
  internal->ages_up_VD_v = (double*) R_Calloc(internal->dim_ages_up_VD_v, double);
  R_Free(internal->becomes_infectious);
  internal->becomes_infectious = (double*) R_Calloc(internal->dim_becomes_infectious, double);
  R_Free(internal->becomes_pre_infectious);
  internal->becomes_pre_infectious = (double*) R_Calloc(internal->dim_becomes_pre_infectious, double);
  R_Free(internal->births_deaths_E);
  internal->births_deaths_E = (double*) R_Calloc(internal->dim_births_deaths_E, double);
  R_Free(internal->births_deaths_I);
  internal->births_deaths_I = (double*) R_Calloc(internal->dim_births_deaths_I, double);
  R_Free(internal->births_deaths_M);
  internal->births_deaths_M = (double*) R_Calloc(internal->dim_births_deaths_M, double);
  R_Free(internal->births_deaths_R);
  internal->births_deaths_R = (double*) R_Calloc(internal->dim_births_deaths_R, double);
  R_Free(internal->births_deaths_S);
  internal->births_deaths_S = (double*) R_Calloc(internal->dim_births_deaths_S, double);
  R_Free(internal->births_deaths_V);
  internal->births_deaths_V = (double*) R_Calloc(internal->dim_births_deaths_V, double);
  R_Free(internal->births_deaths_VD);
  internal->births_deaths_VD = (double*) R_Calloc(internal->dim_births_deaths_VD, double);
  R_Free(internal->gains_immunity);
  internal->gains_immunity = (double*) R_Calloc(internal->dim_gains_immunity, double);
  R_Free(internal->infections_S);
  internal->infections_S = (double*) R_Calloc(internal->dim_infections_S, double);
  R_Free(internal->infections_VD);
  internal->infections_VD = (double*) R_Calloc(internal->dim_infections_VD, double);
  R_Free(internal->initial_E);
  internal->initial_E = (double*) R_Calloc(internal->dim_E, double);
  R_Free(internal->initial_I);
  internal->initial_I = (double*) R_Calloc(internal->dim_I, double);
  R_Free(internal->initial_M);
  internal->initial_M = (double*) R_Calloc(internal->dim_M, double);
  R_Free(internal->initial_R);
  internal->initial_R = (double*) R_Calloc(internal->dim_R, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_V);
  internal->initial_V = (double*) R_Calloc(internal->dim_V, double);
  R_Free(internal->initial_VD);
  internal->initial_VD = (double*) R_Calloc(internal->dim_VD, double);
  R_Free(internal->loses_immunity);
  internal->loses_immunity = (double*) R_Calloc(internal->dim_loses_immunity, double);
  R_Free(internal->susceptible_child_bearing);
  internal->susceptible_child_bearing = (double*) R_Calloc(internal->dim_susceptible_child_bearing, double);
  R_Free(internal->susceptible_pop);
  internal->susceptible_pop = (double*) R_Calloc(internal->dim_susceptible_pop, double);
  R_Free(internal->t_death_rate);
  internal->t_death_rate = (double*) R_Calloc(internal->dim_t_death_rate, double);
  R_Free(internal->t_vaccination_coverage);
  internal->t_vaccination_coverage = (double*) R_Calloc(internal->dim_t_vaccination_coverage, double);
  R_Free(internal->t_vaccination_partial_coverage);
  internal->t_vaccination_partial_coverage = (double*) R_Calloc(internal->dim_t_vaccination_partial_coverage, double);
  R_Free(internal->total_child_bearing);
  internal->total_child_bearing = (double*) R_Calloc(internal->dim_total_child_bearing, double);
  R_Free(internal->total_pop);
  internal->total_pop = (double*) R_Calloc(internal->dim_total_pop, double);
  R_Free(internal->waning_R);
  internal->waning_R = (double*) R_Calloc(internal->dim_waning_R, double);
  R_Free(internal->waning_V);
  internal->waning_V = (double*) R_Calloc(internal->dim_waning_V, double);
  R_Free(internal->waning_VD);
  internal->waning_VD = (double*) R_Calloc(internal->dim_waning_VD, double);
  R_Free(internal->weighted_totals);
  internal->weighted_totals = (double*) R_Calloc(internal->dim_weighted_totals, double);
  internal->child_bearing = (double*) user_get_array(user, false, internal->child_bearing, "child_bearing", NA_REAL, NA_REAL, 1, internal->dim_child_bearing);
  internal->dim_crude_birth_rate = internal->dim_tt_crude_birth_rate;
  internal->dim_crude_death_rate = internal->dim_tt_crude_death_rate;
  internal->dim_R0 = internal->dim_tt_R0;
  internal->dim_vaccination_coverage_1 = internal->dim_tt_vaccination_coverage;
  internal->dim_vaccination_coverage_2 = internal->n_age;
  internal->dim_vaccination_partial_coverage_1 = internal->dim_tt_vaccination_coverage;
  internal->dim_vaccination_partial_coverage_2 = internal->n_age;
  internal->I_0 = (double*) user_get_array(user, false, internal->I_0, "I_0", NA_REAL, NA_REAL, 1, internal->dim_I_0);
  for (int i = 1; i <= internal->dim_E; ++i) {
    internal->initial_E[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_V; ++i) {
    internal->initial_V[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_VD; ++i) {
    internal->initial_VD[i - 1] = 0;
  }
  internal->M_0 = (double*) user_get_array(user, false, internal->M_0, "M_0", NA_REAL, NA_REAL, 1, internal->dim_M_0);
  internal->offset_variable_I = internal->dim_E + internal->dim_S;
  internal->offset_variable_M = internal->dim_E + internal->dim_I + internal->dim_R + internal->dim_S + internal->dim_V + internal->dim_VD;
  internal->offset_variable_R = internal->dim_E + internal->dim_I + internal->dim_S;
  internal->offset_variable_V = internal->dim_E + internal->dim_I + internal->dim_R + internal->dim_S;
  internal->offset_variable_VD = internal->dim_E + internal->dim_I + internal->dim_R + internal->dim_S + internal->dim_V;
  internal->prop_death = (double*) user_get_array(user, false, internal->prop_death, "prop_death", NA_REAL, NA_REAL, 1, internal->dim_prop_death);
  internal->R_0 = (double*) user_get_array(user, false, internal->R_0, "R_0", NA_REAL, NA_REAL, 1, internal->dim_R_0);
  internal->S_0 = (double*) user_get_array(user, false, internal->S_0, "S_0", NA_REAL, NA_REAL, 1, internal->dim_S_0);
  internal->crude_birth_rate = (double*) user_get_array(user, false, internal->crude_birth_rate, "crude_birth_rate", NA_REAL, NA_REAL, 1, internal->dim_crude_birth_rate);
  internal->crude_death_rate = (double*) user_get_array(user, false, internal->crude_death_rate, "crude_death_rate", NA_REAL, NA_REAL, 1, internal->dim_crude_death_rate);
  internal->dim_vaccination_coverage = internal->dim_vaccination_coverage_1 * internal->dim_vaccination_coverage_2;
  internal->dim_vaccination_partial_coverage = internal->dim_vaccination_partial_coverage_1 * internal->dim_vaccination_partial_coverage_2;
  for (int i = 1; i <= internal->dim_I; ++i) {
    internal->initial_I[i - 1] = internal->I_0[i - 1];
  }
  for (int i = 1; i <= internal->dim_M; ++i) {
    internal->initial_M[i - 1] = internal->M_0[i - 1];
  }
  for (int i = 1; i <= internal->dim_R; ++i) {
    internal->initial_R[i - 1] = internal->R_0[i - 1];
  }
  for (int i = 1; i <= internal->dim_S; ++i) {
    internal->initial_S[i - 1] = internal->S_0[i - 1];
  }
  internal->R0 = (double*) user_get_array(user, false, internal->R0, "R0", NA_REAL, NA_REAL, 1, internal->dim_R0);
  interpolate_check_y(internal->dim_tt_crude_birth_rate, internal->dim_crude_birth_rate, 0, "crude_birth_rate", "t_crude_birth_rate");
  cinterpolate_free(internal->interpolate_t_crude_birth_rate);
  internal->interpolate_t_crude_birth_rate = cinterpolate_alloc("constant", internal->dim_tt_crude_birth_rate, 1, internal->tt_crude_birth_rate, internal->crude_birth_rate, true, false);
  interpolate_check_y(internal->dim_tt_crude_death_rate, internal->dim_crude_death_rate, 0, "crude_death_rate", "t_crude_death_rate");
  cinterpolate_free(internal->interpolate_t_crude_death_rate);
  internal->interpolate_t_crude_death_rate = cinterpolate_alloc("constant", internal->dim_tt_crude_death_rate, 1, internal->tt_crude_death_rate, internal->crude_death_rate, true, false);
  interpolate_check_y(internal->dim_tt_R0, internal->dim_R0, 0, "R0", "t_R0");
  cinterpolate_free(internal->interpolate_t_R0);
  internal->interpolate_t_R0 = cinterpolate_alloc("constant", internal->dim_tt_R0, 1, internal->tt_R0, internal->R0, true, false);
  internal->vaccination_coverage = (double*) user_get_array(user, false, internal->vaccination_coverage, "vaccination_coverage", NA_REAL, NA_REAL, 2, internal->dim_vaccination_coverage_1, internal->dim_vaccination_coverage_2);
  internal->vaccination_partial_coverage = (double*) user_get_array(user, false, internal->vaccination_partial_coverage, "vaccination_partial_coverage", NA_REAL, NA_REAL, 2, internal->dim_vaccination_partial_coverage_1, internal->dim_vaccination_partial_coverage_2);
  interpolate_check_y(internal->dim_tt_vaccination_coverage, internal->dim_vaccination_coverage_1, 1, "vaccination_coverage", "t_vaccination_coverage");
  interpolate_check_y(internal->dim_t_vaccination_coverage, internal->dim_vaccination_coverage_2, 2, "vaccination_coverage", "t_vaccination_coverage");
  cinterpolate_free(internal->interpolate_t_vaccination_coverage);
  internal->interpolate_t_vaccination_coverage = cinterpolate_alloc("constant", internal->dim_tt_vaccination_coverage, internal->dim_t_vaccination_coverage, internal->tt_vaccination_coverage, internal->vaccination_coverage, true, false);
  interpolate_check_y(internal->dim_tt_vaccination_coverage, internal->dim_vaccination_partial_coverage_1, 1, "vaccination_partial_coverage", "t_vaccination_partial_coverage");
  interpolate_check_y(internal->dim_t_vaccination_partial_coverage, internal->dim_vaccination_partial_coverage_2, 2, "vaccination_partial_coverage", "t_vaccination_partial_coverage");
  cinterpolate_free(internal->interpolate_t_vaccination_partial_coverage);
  internal->interpolate_t_vaccination_partial_coverage = cinterpolate_alloc("constant", internal->dim_tt_vaccination_coverage, internal->dim_t_vaccination_partial_coverage, internal->tt_vaccination_coverage, internal->vaccination_partial_coverage, true, false);
  return R_NilValue;
}
SEXP dynamic_model_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP dynamic_model_use_dde_ptr) {
  return R_NilValue;
}
SEXP dynamic_model_metadata(SEXP internal_p) {
  dynamic_model_internal *internal = dynamic_model_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 7));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 7));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(variable_length, 1, ScalarInteger(internal->dim_E));
  SET_VECTOR_ELT(variable_length, 2, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(variable_length, 3, ScalarInteger(internal->dim_R));
  SET_VECTOR_ELT(variable_length, 4, ScalarInteger(internal->dim_V));
  SET_VECTOR_ELT(variable_length, 5, ScalarInteger(internal->dim_VD));
  SET_VECTOR_ELT(variable_length, 6, ScalarInteger(internal->dim_M));
  SET_STRING_ELT(variable_names, 0, mkChar("S"));
  SET_STRING_ELT(variable_names, 1, mkChar("E"));
  SET_STRING_ELT(variable_names, 2, mkChar("I"));
  SET_STRING_ELT(variable_names, 3, mkChar("R"));
  SET_STRING_ELT(variable_names, 4, mkChar("V"));
  SET_STRING_ELT(variable_names, 5, mkChar("VD"));
  SET_STRING_ELT(variable_names, 6, mkChar("M"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 1, R_NilValue);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(0));
  SEXP interpolate_t = PROTECT(allocVector(VECSXP, 3));
  SEXP interpolate_t_nms = PROTECT(allocVector(STRSXP, 3));
  setAttrib(interpolate_t, R_NamesSymbol, interpolate_t_nms);
  SET_VECTOR_ELT(interpolate_t, 0, ScalarReal(fmax(internal->tt_crude_birth_rate[0], fmax(internal->tt_crude_death_rate[0], fmax(internal->tt_R0[0], internal->tt_vaccination_coverage[0])))));
  SET_VECTOR_ELT(interpolate_t, 1, ScalarReal(R_PosInf));
  SET_STRING_ELT(interpolate_t_nms, 0, mkChar("min"));
  SET_STRING_ELT(interpolate_t_nms, 1, mkChar("max"));
  SET_VECTOR_ELT(ret, 3, interpolate_t);
  UNPROTECT(2);
  UNPROTECT(2);
  return ret;
}
SEXP dynamic_model_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  dynamic_model_internal *internal = dynamic_model_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_E + internal->dim_I + internal->dim_M + internal->dim_R + internal->dim_S + internal->dim_V + internal->dim_VD));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->dim_S, internal->initial_E, internal->dim_E * sizeof(double));
  memcpy(state + internal->offset_variable_I, internal->initial_I, internal->dim_I * sizeof(double));
  memcpy(state + internal->offset_variable_R, internal->initial_R, internal->dim_R * sizeof(double));
  memcpy(state + internal->offset_variable_V, internal->initial_V, internal->dim_V * sizeof(double));
  memcpy(state + internal->offset_variable_VD, internal->initial_VD, internal->dim_VD * sizeof(double));
  memcpy(state + internal->offset_variable_M, internal->initial_M, internal->dim_M * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void dynamic_model_rhs(dynamic_model_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * S = state + 0;
  double * E = state + internal->dim_S;
  double * I = state + internal->offset_variable_I;
  double * R = state + internal->offset_variable_R;
  double * V = state + internal->offset_variable_V;
  double * VD = state + internal->offset_variable_VD;
  double * M = state + internal->offset_variable_M;
  for (int i = 1; i <= internal->dim_ages_up_E; ++i) {
    internal->ages_up_E[i - 1] = E[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_I; ++i) {
    internal->ages_up_I[i - 1] = I[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_M; ++i) {
    internal->ages_up_M[i - 1] = M[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_R; ++i) {
    internal->ages_up_R[i - 1] = R[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S; ++i) {
    internal->ages_up_S[i - 1] = S[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_V; ++i) {
    internal->ages_up_V[i - 1] = V[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_VD; ++i) {
    internal->ages_up_VD[i - 1] = VD[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_becomes_infectious; ++i) {
    internal->becomes_infectious[i - 1] = internal->pre_infectious_transition_rate * E[i - 1];
  }
  for (int i = 1; i <= internal->dim_gains_immunity; ++i) {
    internal->gains_immunity[i - 1] = internal->infectious_transition_rate * I[i - 1];
  }
  for (int i = 1; i <= internal->dim_susceptible_pop; ++i) {
    internal->susceptible_pop[i - 1] = S[i - 1] + VD[i - 1];
  }
  for (int i = 1; i <= internal->n_maternal; ++i) {
    internal->total_pop[i - 1] = R[i - 1] + S[i - 1] + V[i - 1] + M[i - 1] + VD[i - 1];
  }
  for (int i = (internal->n_maternal + 1); i <= internal->n_age; ++i) {
    internal->total_pop[i - 1] = R[i - 1] + S[i - 1] + V[i - 1] + VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_waning_R; ++i) {
    internal->waning_R[i - 1] = internal->waning * R[i - 1];
  }
  for (int i = 1; i <= internal->dim_waning_V; ++i) {
    internal->waning_V[i - 1] = internal->waning * V[i - 1];
  }
  for (int i = 1; i <= internal->dim_waning_VD; ++i) {
    internal->waning_VD[i - 1] = internal->waning * VD[i - 1];
  }
  {
     int i = 1;
     internal->ageing_E[i - 1] = -(internal->ages_up_E[i - 1]);
  }
  for (int i = 2; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_E[i - 1] = internal->ages_up_E[i - 1 - 1] - internal->ages_up_E[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_E[i - 1] = internal->ages_up_E[i - 1 - 1];
  }
  {
     int i = 1;
     internal->ageing_I[i - 1] = -(internal->ages_up_I[i - 1]);
  }
  for (int i = 2; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_I[i - 1] = internal->ages_up_I[i - 1 - 1] - internal->ages_up_I[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_I[i - 1] = internal->ages_up_I[i - 1 - 1];
  }
  for (int i = 1; i <= internal->dim_loses_immunity; ++i) {
    internal->loses_immunity[i - 1] = internal->waning_R[i - 1] + internal->waning_V[i - 1] + internal->waning_VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_susceptible_child_bearing; ++i) {
    internal->susceptible_child_bearing[i - 1] = (internal->susceptible_pop[i - 1]) * internal->child_bearing[i - 1];
  }
  for (int i = 1; i <= internal->dim_total_child_bearing; ++i) {
    internal->total_child_bearing[i - 1] = internal->total_pop[i - 1] * internal->child_bearing[i - 1];
  }
  for (int i = 1; i <= internal->dim_weighted_totals; ++i) {
    internal->weighted_totals[i - 1] = internal->prop_death[i - 1] * internal->total_pop[i - 1];
  }
  double t_crude_birth_rate = 0.0;
  cinterpolate_eval(t, internal->interpolate_t_crude_birth_rate, &t_crude_birth_rate);
  double t_crude_death_rate = 0.0;
  cinterpolate_eval(t, internal->interpolate_t_crude_death_rate, &t_crude_death_rate);
  double t_R0 = 0.0;
  cinterpolate_eval(t, internal->interpolate_t_R0, &t_R0);
  double beta = t_R0 * internal->infectious_transition_rate;
  double births_total = (odin_sum1(internal->total_pop, 0, internal->dim_total_pop)) * t_crude_birth_rate;
  for (int i = 1; i <= internal->dim_t_death_rate; ++i) {
    internal->t_death_rate[i - 1] = fmin(t_crude_death_rate * internal->prop_death[i - 1] * odin_sum1(internal->total_pop, 0, internal->dim_total_pop) / (double) odin_sum1(internal->weighted_totals, 0, internal->dim_weighted_totals), 1);
  }
  cinterpolate_eval(t, internal->interpolate_t_vaccination_coverage, internal->t_vaccination_coverage);
  cinterpolate_eval(t, internal->interpolate_t_vaccination_partial_coverage, internal->t_vaccination_partial_coverage);
  for (int i = 1; i <= internal->dim_ages_up_M_v; ++i) {
    internal->ages_up_M_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_M[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_R_v; ++i) {
    internal->ages_up_R_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_R[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S_pv; ++i) {
    internal->ages_up_S_pv[i - 1] = internal->t_vaccination_partial_coverage[i - 1] * internal->ages_up_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S_v; ++i) {
    internal->ages_up_S_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_VD_v; ++i) {
    internal->ages_up_VD_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_E; ++i) {
    internal->births_deaths_E[i - 1] = -(internal->t_death_rate[i - 1]) * E[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_I; ++i) {
    internal->births_deaths_I[i - 1] = -(internal->t_death_rate[i - 1]) * I[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_R; ++i) {
    internal->births_deaths_R[i - 1] = -(internal->t_death_rate[i - 1]) * R[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_V; ++i) {
    internal->births_deaths_V[i - 1] = -(internal->t_death_rate[i - 1]) * V[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_VD; ++i) {
    internal->births_deaths_VD[i - 1] = -(internal->t_death_rate[i - 1]) * VD[i - 1];
  }
  double births_S = births_total * (odin_sum1(internal->susceptible_child_bearing, 0, internal->dim_susceptible_child_bearing) / (double) odin_sum1(internal->total_child_bearing, 0, internal->dim_total_child_bearing));
  double foi = beta * odin_sum1(I, 0, internal->dim_I);
  {
     int i = 1;
     internal->ageing_V[i - 1] = -(internal->ages_up_V[i - 1]);
  }
  for (int i = 2; i <= internal->age_group_loses_maternal; ++i) {
    internal->ageing_V[i - 1] = internal->ages_up_M_v[i - 1 - 1] + internal->ages_up_V[i - 1 - 1] + internal->ages_up_S_v[i - 1 - 1] + internal->ages_up_R_v[i - 1 - 1] + internal->ages_up_VD_v[i - 1 - 1] - internal->ages_up_V[i - 1];
  }
  for (int i = internal->age_group_no_maternal; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_V[i - 1] = internal->ages_up_V[i - 1 - 1] + internal->ages_up_S_v[i - 1 - 1] + internal->ages_up_R_v[i - 1 - 1] + internal->ages_up_VD_v[i - 1 - 1] - internal->ages_up_V[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_V[i - 1] = internal->ages_up_V[i - 1 - 1] + internal->ages_up_S_v[i - 1 - 1] + internal->ages_up_R_v[i - 1 - 1] + internal->ages_up_VD_v[i - 1 - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_M_nv; ++i) {
    internal->ages_up_M_nv[i - 1] = internal->ages_up_M[i - 1] - internal->ages_up_M_v[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_R_nv; ++i) {
    internal->ages_up_R_nv[i - 1] = internal->ages_up_R[i - 1] - internal->ages_up_R_v[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S_nv; ++i) {
    internal->ages_up_S_nv[i - 1] = internal->ages_up_S[i - 1] - internal->ages_up_S_v[i - 1] - internal->ages_up_S_pv[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_VD_nv; ++i) {
    internal->ages_up_VD_nv[i - 1] = internal->ages_up_VD[i - 1] - internal->ages_up_VD_v[i - 1];
  }
  {
     int i = 1;
     internal->births_deaths_S[i - 1] = births_S - internal->t_death_rate[i - 1] * S[i - 1];
  }
  for (int i = 2; i <= internal->n_age; ++i) {
    internal->births_deaths_S[i - 1] = -(internal->t_death_rate[i - 1]) * S[i - 1];
  }
  double births_M = births_total - births_S;
  for (int i = 1; i <= internal->dim_I; ++i) {
    dstatedt[internal->offset_variable_I + i - 1] = internal->births_deaths_I[i - 1] + internal->ageing_I[i - 1] + internal->becomes_infectious[i - 1] - internal->gains_immunity[i - 1];
  }
  for (int i = 1; i <= internal->dim_infections_S; ++i) {
    internal->infections_S[i - 1] = foi * S[i - 1];
  }
  for (int i = 1; i <= internal->dim_infections_VD; ++i) {
    internal->infections_VD[i - 1] = foi * VD[i - 1];
  }
  {
     int i = 1;
     internal->ageing_M[i - 1] = -(internal->ages_up_M[i - 1]);
  }
  for (int i = 2; i <= internal->n_maternal; ++i) {
    internal->ageing_M[i - 1] = internal->ages_up_M_nv[i - 1 - 1] - internal->ages_up_M[i - 1];
  }
  {
     int i = 1;
     internal->ageing_R[i - 1] = -(internal->ages_up_R[i - 1]);
  }
  for (int i = 2; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_R[i - 1] = internal->ages_up_R_nv[i - 1 - 1] - internal->ages_up_R[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_R[i - 1] = internal->ages_up_R_nv[i - 1 - 1];
  }
  {
     int i = 1;
     internal->ageing_S[i - 1] = -(internal->ages_up_S[i - 1]);
  }
  for (int i = 2; i <= internal->n_maternal; ++i) {
    internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1] - internal->ages_up_S[i - 1];
  }
  {
     int i = internal->age_group_loses_maternal;
     internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1] + internal->ages_up_M_nv[i - 1 - 1] - internal->ages_up_S[i - 1];
  }
  for (int i = internal->age_group_no_maternal; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1] - internal->ages_up_S[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1];
  }
  {
     int i = 1;
     internal->ageing_VD[i - 1] = -(internal->ages_up_VD[i - 1]);
  }
  for (int i = 2; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_VD[i - 1] = internal->ages_up_VD_nv[i - 1 - 1] + internal->ages_up_S_pv[i - 1 - 1] - internal->ages_up_VD[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_VD[i - 1] = internal->ages_up_VD_nv[i - 1 - 1] + internal->ages_up_S_pv[i - 1 - 1];
  }
  for (int i = 1; i <= internal->dim_becomes_pre_infectious; ++i) {
    internal->becomes_pre_infectious[i - 1] = internal->infections_S[i - 1] + internal->infections_VD[i - 1];
  }
  {
     int i = 1;
     internal->births_deaths_M[i - 1] = births_M - internal->t_death_rate[i - 1] * M[i - 1];
  }
  for (int i = 2; i <= internal->n_maternal; ++i) {
    internal->births_deaths_M[i - 1] = -(internal->t_death_rate[i - 1]) * M[i - 1];
  }
  for (int i = 1; i <= internal->dim_V; ++i) {
    dstatedt[internal->offset_variable_V + i - 1] = internal->births_deaths_V[i - 1] + internal->ageing_V[i - 1] - internal->waning_V[i - 1];
  }
  for (int i = 1; i <= internal->dim_E; ++i) {
    dstatedt[internal->dim_S + i - 1] = internal->births_deaths_E[i - 1] + internal->ageing_E[i - 1] + internal->becomes_pre_infectious[i - 1] - internal->becomes_infectious[i - 1];
  }
  for (int i = 1; i <= internal->dim_M; ++i) {
    dstatedt[internal->offset_variable_M + i - 1] = internal->births_deaths_M[i - 1] + internal->ageing_M[i - 1];
  }
  for (int i = 1; i <= internal->dim_R; ++i) {
    dstatedt[internal->offset_variable_R + i - 1] = internal->births_deaths_R[i - 1] + internal->ageing_R[i - 1] + internal->gains_immunity[i - 1] - internal->waning_R[i - 1];
  }
  for (int i = 1; i <= internal->dim_S; ++i) {
    dstatedt[0 + i - 1] = internal->births_deaths_S[i - 1] + internal->ageing_S[i - 1] + internal->loses_immunity[i - 1] - internal->infections_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_VD; ++i) {
    dstatedt[internal->offset_variable_VD + i - 1] = internal->births_deaths_VD[i - 1] + internal->ageing_VD[i - 1] - internal->waning_VD[i - 1] - internal->infections_VD[i - 1];
  }
}
void dynamic_model_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  dynamic_model_rhs((dynamic_model_internal*)internal, t, state, dstatedt, NULL);
}
void dynamic_model_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  dynamic_model_rhs(dynamic_model_internal_ds, *t, state, dstatedt, output);
}
SEXP dynamic_model_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  dynamic_model_internal *internal = dynamic_model_get_internal(internal_p, 1);
  double *output = NULL;
  dynamic_model_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
static_model_internal* static_model_get_internal(SEXP internal_p, int closed_error) {
  static_model_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (static_model_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void static_model_finalise(SEXP internal_p) {
  static_model_internal *internal = static_model_get_internal(internal_p, 0);
  if (internal_p) {
    cinterpolate_free(internal->interpolate_t_crude_birth_rate);
    cinterpolate_free(internal->interpolate_t_crude_death_rate);
    cinterpolate_free(internal->interpolate_t_crude_foi);
    cinterpolate_free(internal->interpolate_t_vaccination_coverage);
    cinterpolate_free(internal->interpolate_t_vaccination_partial_coverage);
    internal->interpolate_t_crude_birth_rate = NULL;
    internal->interpolate_t_crude_death_rate = NULL;
    internal->interpolate_t_crude_foi = NULL;
    internal->interpolate_t_vaccination_coverage = NULL;
    internal->interpolate_t_vaccination_partial_coverage = NULL;
    R_Free(internal->age_rate);
    R_Free(internal->ageing_M);
    R_Free(internal->ageing_R);
    R_Free(internal->ageing_S);
    R_Free(internal->ageing_V);
    R_Free(internal->ageing_VD);
    R_Free(internal->ages_up_M);
    R_Free(internal->ages_up_M_nv);
    R_Free(internal->ages_up_M_v);
    R_Free(internal->ages_up_R);
    R_Free(internal->ages_up_R_nv);
    R_Free(internal->ages_up_R_v);
    R_Free(internal->ages_up_S);
    R_Free(internal->ages_up_S_nv);
    R_Free(internal->ages_up_S_pv);
    R_Free(internal->ages_up_S_v);
    R_Free(internal->ages_up_V);
    R_Free(internal->ages_up_VD);
    R_Free(internal->ages_up_VD_nv);
    R_Free(internal->ages_up_VD_v);
    R_Free(internal->births_deaths_M);
    R_Free(internal->births_deaths_R);
    R_Free(internal->births_deaths_S);
    R_Free(internal->births_deaths_V);
    R_Free(internal->births_deaths_VD);
    R_Free(internal->child_bearing);
    R_Free(internal->crude_birth_rate);
    R_Free(internal->crude_death_rate);
    R_Free(internal->crude_foi);
    R_Free(internal->gains_immunity);
    R_Free(internal->infections_S);
    R_Free(internal->infections_VD);
    R_Free(internal->initial_M);
    R_Free(internal->initial_R);
    R_Free(internal->initial_S);
    R_Free(internal->initial_V);
    R_Free(internal->initial_VD);
    R_Free(internal->loses_immunity);
    R_Free(internal->M_0);
    R_Free(internal->prop_death);
    R_Free(internal->R_0);
    R_Free(internal->S_0);
    R_Free(internal->susceptible_child_bearing);
    R_Free(internal->susceptible_pop);
    R_Free(internal->t_death_rate);
    R_Free(internal->t_vaccination_coverage);
    R_Free(internal->t_vaccination_partial_coverage);
    R_Free(internal->total_child_bearing);
    R_Free(internal->total_pop);
    R_Free(internal->tt_crude_birth_rate);
    R_Free(internal->tt_crude_death_rate);
    R_Free(internal->tt_crude_foi);
    R_Free(internal->tt_vaccination_coverage);
    R_Free(internal->vaccination_coverage);
    R_Free(internal->vaccination_partial_coverage);
    R_Free(internal->waning_R);
    R_Free(internal->waning_V);
    R_Free(internal->waning_VD);
    R_Free(internal->weighted_totals);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP static_model_create(SEXP user) {
  static_model_internal *internal = (static_model_internal*) R_Calloc(1, static_model_internal);
  internal->age_rate = NULL;
  internal->ageing_M = NULL;
  internal->ageing_R = NULL;
  internal->ageing_S = NULL;
  internal->ageing_V = NULL;
  internal->ageing_VD = NULL;
  internal->ages_up_M = NULL;
  internal->ages_up_M_nv = NULL;
  internal->ages_up_M_v = NULL;
  internal->ages_up_R = NULL;
  internal->ages_up_R_nv = NULL;
  internal->ages_up_R_v = NULL;
  internal->ages_up_S = NULL;
  internal->ages_up_S_nv = NULL;
  internal->ages_up_S_pv = NULL;
  internal->ages_up_S_v = NULL;
  internal->ages_up_V = NULL;
  internal->ages_up_VD = NULL;
  internal->ages_up_VD_nv = NULL;
  internal->ages_up_VD_v = NULL;
  internal->births_deaths_M = NULL;
  internal->births_deaths_R = NULL;
  internal->births_deaths_S = NULL;
  internal->births_deaths_V = NULL;
  internal->births_deaths_VD = NULL;
  internal->child_bearing = NULL;
  internal->crude_birth_rate = NULL;
  internal->crude_death_rate = NULL;
  internal->crude_foi = NULL;
  internal->gains_immunity = NULL;
  internal->infections_S = NULL;
  internal->infections_VD = NULL;
  internal->initial_M = NULL;
  internal->initial_R = NULL;
  internal->initial_S = NULL;
  internal->initial_V = NULL;
  internal->initial_VD = NULL;
  internal->interpolate_t_vaccination_coverage = NULL;
  internal->interpolate_t_vaccination_partial_coverage = NULL;
  internal->loses_immunity = NULL;
  internal->M_0 = NULL;
  internal->prop_death = NULL;
  internal->R_0 = NULL;
  internal->S_0 = NULL;
  internal->susceptible_child_bearing = NULL;
  internal->susceptible_pop = NULL;
  internal->t_death_rate = NULL;
  internal->t_vaccination_coverage = NULL;
  internal->t_vaccination_partial_coverage = NULL;
  internal->total_child_bearing = NULL;
  internal->total_pop = NULL;
  internal->tt_crude_birth_rate = NULL;
  internal->tt_crude_death_rate = NULL;
  internal->tt_crude_foi = NULL;
  internal->tt_vaccination_coverage = NULL;
  internal->vaccination_coverage = NULL;
  internal->vaccination_partial_coverage = NULL;
  internal->waning_R = NULL;
  internal->waning_V = NULL;
  internal->waning_VD = NULL;
  internal->weighted_totals = NULL;
  internal->adjust_for_crude_foi = NA_REAL;
  internal->age_rate = NULL;
  internal->child_bearing = NULL;
  internal->crude_birth_rate = NULL;
  internal->crude_death_rate = NULL;
  internal->crude_foi = NULL;
  internal->M_0 = NULL;
  internal->n_age = NA_INTEGER;
  internal->n_maternal = NA_INTEGER;
  internal->prop_death = NULL;
  internal->R_0 = NULL;
  internal->S_0 = NULL;
  internal->tt_crude_birth_rate = NULL;
  internal->tt_crude_death_rate = NULL;
  internal->tt_crude_foi = NULL;
  internal->tt_vaccination_coverage = NULL;
  internal->vaccination_coverage = NULL;
  internal->vaccination_partial_coverage = NULL;
  internal->waning = NA_REAL;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, static_model_finalise);
  UNPROTECT(1);
  return ptr;
}
static static_model_internal *static_model_internal_ds;
void static_model_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  static_model_internal_ds = static_model_get_internal(get_desolve_gparms(), 1);
}
SEXP static_model_contents(SEXP internal_p) {
  static_model_internal *internal = static_model_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 137));
  SET_VECTOR_ELT(contents, 0, ScalarReal(internal->adjust_for_crude_foi));
  SET_VECTOR_ELT(contents, 1, ScalarInteger(internal->age_group_loses_maternal));
  SET_VECTOR_ELT(contents, 2, ScalarInteger(internal->age_group_no_maternal));
  SEXP age_rate = PROTECT(allocVector(REALSXP, internal->dim_age_rate));
  memcpy(REAL(age_rate), internal->age_rate, internal->dim_age_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 3, age_rate);
  SEXP ageing_M = PROTECT(allocVector(REALSXP, internal->dim_ageing_M));
  memcpy(REAL(ageing_M), internal->ageing_M, internal->dim_ageing_M * sizeof(double));
  SET_VECTOR_ELT(contents, 4, ageing_M);
  SEXP ageing_R = PROTECT(allocVector(REALSXP, internal->dim_ageing_R));
  memcpy(REAL(ageing_R), internal->ageing_R, internal->dim_ageing_R * sizeof(double));
  SET_VECTOR_ELT(contents, 5, ageing_R);
  SEXP ageing_S = PROTECT(allocVector(REALSXP, internal->dim_ageing_S));
  memcpy(REAL(ageing_S), internal->ageing_S, internal->dim_ageing_S * sizeof(double));
  SET_VECTOR_ELT(contents, 6, ageing_S);
  SEXP ageing_V = PROTECT(allocVector(REALSXP, internal->dim_ageing_V));
  memcpy(REAL(ageing_V), internal->ageing_V, internal->dim_ageing_V * sizeof(double));
  SET_VECTOR_ELT(contents, 7, ageing_V);
  SEXP ageing_VD = PROTECT(allocVector(REALSXP, internal->dim_ageing_VD));
  memcpy(REAL(ageing_VD), internal->ageing_VD, internal->dim_ageing_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 8, ageing_VD);
  SEXP ages_up_M = PROTECT(allocVector(REALSXP, internal->dim_ages_up_M));
  memcpy(REAL(ages_up_M), internal->ages_up_M, internal->dim_ages_up_M * sizeof(double));
  SET_VECTOR_ELT(contents, 9, ages_up_M);
  SEXP ages_up_M_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_M_nv));
  memcpy(REAL(ages_up_M_nv), internal->ages_up_M_nv, internal->dim_ages_up_M_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 10, ages_up_M_nv);
  SEXP ages_up_M_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_M_v));
  memcpy(REAL(ages_up_M_v), internal->ages_up_M_v, internal->dim_ages_up_M_v * sizeof(double));
  SET_VECTOR_ELT(contents, 11, ages_up_M_v);
  SEXP ages_up_R = PROTECT(allocVector(REALSXP, internal->dim_ages_up_R));
  memcpy(REAL(ages_up_R), internal->ages_up_R, internal->dim_ages_up_R * sizeof(double));
  SET_VECTOR_ELT(contents, 12, ages_up_R);
  SEXP ages_up_R_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_R_nv));
  memcpy(REAL(ages_up_R_nv), internal->ages_up_R_nv, internal->dim_ages_up_R_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 13, ages_up_R_nv);
  SEXP ages_up_R_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_R_v));
  memcpy(REAL(ages_up_R_v), internal->ages_up_R_v, internal->dim_ages_up_R_v * sizeof(double));
  SET_VECTOR_ELT(contents, 14, ages_up_R_v);
  SEXP ages_up_S = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S));
  memcpy(REAL(ages_up_S), internal->ages_up_S, internal->dim_ages_up_S * sizeof(double));
  SET_VECTOR_ELT(contents, 15, ages_up_S);
  SEXP ages_up_S_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S_nv));
  memcpy(REAL(ages_up_S_nv), internal->ages_up_S_nv, internal->dim_ages_up_S_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 16, ages_up_S_nv);
  SEXP ages_up_S_pv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S_pv));
  memcpy(REAL(ages_up_S_pv), internal->ages_up_S_pv, internal->dim_ages_up_S_pv * sizeof(double));
  SET_VECTOR_ELT(contents, 17, ages_up_S_pv);
  SEXP ages_up_S_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_S_v));
  memcpy(REAL(ages_up_S_v), internal->ages_up_S_v, internal->dim_ages_up_S_v * sizeof(double));
  SET_VECTOR_ELT(contents, 18, ages_up_S_v);
  SEXP ages_up_V = PROTECT(allocVector(REALSXP, internal->dim_ages_up_V));
  memcpy(REAL(ages_up_V), internal->ages_up_V, internal->dim_ages_up_V * sizeof(double));
  SET_VECTOR_ELT(contents, 19, ages_up_V);
  SEXP ages_up_VD = PROTECT(allocVector(REALSXP, internal->dim_ages_up_VD));
  memcpy(REAL(ages_up_VD), internal->ages_up_VD, internal->dim_ages_up_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 20, ages_up_VD);
  SEXP ages_up_VD_nv = PROTECT(allocVector(REALSXP, internal->dim_ages_up_VD_nv));
  memcpy(REAL(ages_up_VD_nv), internal->ages_up_VD_nv, internal->dim_ages_up_VD_nv * sizeof(double));
  SET_VECTOR_ELT(contents, 21, ages_up_VD_nv);
  SEXP ages_up_VD_v = PROTECT(allocVector(REALSXP, internal->dim_ages_up_VD_v));
  memcpy(REAL(ages_up_VD_v), internal->ages_up_VD_v, internal->dim_ages_up_VD_v * sizeof(double));
  SET_VECTOR_ELT(contents, 22, ages_up_VD_v);
  SEXP births_deaths_M = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_M));
  memcpy(REAL(births_deaths_M), internal->births_deaths_M, internal->dim_births_deaths_M * sizeof(double));
  SET_VECTOR_ELT(contents, 23, births_deaths_M);
  SEXP births_deaths_R = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_R));
  memcpy(REAL(births_deaths_R), internal->births_deaths_R, internal->dim_births_deaths_R * sizeof(double));
  SET_VECTOR_ELT(contents, 24, births_deaths_R);
  SEXP births_deaths_S = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_S));
  memcpy(REAL(births_deaths_S), internal->births_deaths_S, internal->dim_births_deaths_S * sizeof(double));
  SET_VECTOR_ELT(contents, 25, births_deaths_S);
  SEXP births_deaths_V = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_V));
  memcpy(REAL(births_deaths_V), internal->births_deaths_V, internal->dim_births_deaths_V * sizeof(double));
  SET_VECTOR_ELT(contents, 26, births_deaths_V);
  SEXP births_deaths_VD = PROTECT(allocVector(REALSXP, internal->dim_births_deaths_VD));
  memcpy(REAL(births_deaths_VD), internal->births_deaths_VD, internal->dim_births_deaths_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 27, births_deaths_VD);
  SEXP child_bearing = PROTECT(allocVector(REALSXP, internal->dim_child_bearing));
  memcpy(REAL(child_bearing), internal->child_bearing, internal->dim_child_bearing * sizeof(double));
  SET_VECTOR_ELT(contents, 28, child_bearing);
  SEXP crude_birth_rate = PROTECT(allocVector(REALSXP, internal->dim_crude_birth_rate));
  memcpy(REAL(crude_birth_rate), internal->crude_birth_rate, internal->dim_crude_birth_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 29, crude_birth_rate);
  SEXP crude_death_rate = PROTECT(allocVector(REALSXP, internal->dim_crude_death_rate));
  memcpy(REAL(crude_death_rate), internal->crude_death_rate, internal->dim_crude_death_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 30, crude_death_rate);
  SEXP crude_foi = PROTECT(allocVector(REALSXP, internal->dim_crude_foi));
  memcpy(REAL(crude_foi), internal->crude_foi, internal->dim_crude_foi * sizeof(double));
  SET_VECTOR_ELT(contents, 31, crude_foi);
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_age_rate));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_ageing_M));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_ageing_R));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_ageing_S));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_ageing_V));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_ageing_VD));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_ages_up_M));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_ages_up_M_nv));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_ages_up_M_v));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_ages_up_R));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_ages_up_R_nv));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_ages_up_R_v));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_ages_up_S));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_ages_up_S_nv));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_ages_up_S_pv));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_ages_up_S_v));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_ages_up_V));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_ages_up_VD));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_ages_up_VD_nv));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_ages_up_VD_v));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_births_deaths_M));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_births_deaths_R));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_births_deaths_S));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_births_deaths_V));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_births_deaths_VD));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_child_bearing));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_crude_birth_rate));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_crude_death_rate));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_crude_foi));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_gains_immunity));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_infections_S));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_infections_VD));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_loses_immunity));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_M));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_M_0));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_prop_death));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_R));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_R_0));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_S_0));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_susceptible_child_bearing));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_susceptible_pop));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_t_death_rate));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_t_vaccination_coverage));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_t_vaccination_partial_coverage));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_total_child_bearing));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_total_pop));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_tt_crude_birth_rate));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_tt_crude_death_rate));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_tt_crude_foi));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_tt_vaccination_coverage));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_V));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_vaccination_coverage));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_vaccination_coverage_1));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_vaccination_coverage_2));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_vaccination_partial_coverage));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_vaccination_partial_coverage_1));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_vaccination_partial_coverage_2));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_VD));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_waning_R));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_waning_V));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_waning_VD));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_weighted_totals));
  SEXP gains_immunity = PROTECT(allocVector(REALSXP, internal->dim_gains_immunity));
  memcpy(REAL(gains_immunity), internal->gains_immunity, internal->dim_gains_immunity * sizeof(double));
  SET_VECTOR_ELT(contents, 95, gains_immunity);
  SEXP infections_S = PROTECT(allocVector(REALSXP, internal->dim_infections_S));
  memcpy(REAL(infections_S), internal->infections_S, internal->dim_infections_S * sizeof(double));
  SET_VECTOR_ELT(contents, 96, infections_S);
  SEXP infections_VD = PROTECT(allocVector(REALSXP, internal->dim_infections_VD));
  memcpy(REAL(infections_VD), internal->infections_VD, internal->dim_infections_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 97, infections_VD);
  SEXP initial_M = PROTECT(allocVector(REALSXP, internal->dim_M));
  memcpy(REAL(initial_M), internal->initial_M, internal->dim_M * sizeof(double));
  SET_VECTOR_ELT(contents, 98, initial_M);
  SEXP initial_R = PROTECT(allocVector(REALSXP, internal->dim_R));
  memcpy(REAL(initial_R), internal->initial_R, internal->dim_R * sizeof(double));
  SET_VECTOR_ELT(contents, 99, initial_R);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  SET_VECTOR_ELT(contents, 100, initial_S);
  SEXP initial_V = PROTECT(allocVector(REALSXP, internal->dim_V));
  memcpy(REAL(initial_V), internal->initial_V, internal->dim_V * sizeof(double));
  SET_VECTOR_ELT(contents, 101, initial_V);
  SEXP initial_VD = PROTECT(allocVector(REALSXP, internal->dim_VD));
  memcpy(REAL(initial_VD), internal->initial_VD, internal->dim_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 102, initial_VD);
  SEXP loses_immunity = PROTECT(allocVector(REALSXP, internal->dim_loses_immunity));
  memcpy(REAL(loses_immunity), internal->loses_immunity, internal->dim_loses_immunity * sizeof(double));
  SET_VECTOR_ELT(contents, 108, loses_immunity);
  SEXP M_0 = PROTECT(allocVector(REALSXP, internal->dim_M_0));
  memcpy(REAL(M_0), internal->M_0, internal->dim_M_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 109, M_0);
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->n_age));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->n_age_penultimate));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->n_maternal));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->offset_variable_M));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->offset_variable_V));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->offset_variable_VD));
  SEXP prop_death = PROTECT(allocVector(REALSXP, internal->dim_prop_death));
  memcpy(REAL(prop_death), internal->prop_death, internal->dim_prop_death * sizeof(double));
  SET_VECTOR_ELT(contents, 116, prop_death);
  SEXP R_0 = PROTECT(allocVector(REALSXP, internal->dim_R_0));
  memcpy(REAL(R_0), internal->R_0, internal->dim_R_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 117, R_0);
  SEXP S_0 = PROTECT(allocVector(REALSXP, internal->dim_S_0));
  memcpy(REAL(S_0), internal->S_0, internal->dim_S_0 * sizeof(double));
  SET_VECTOR_ELT(contents, 118, S_0);
  SEXP susceptible_child_bearing = PROTECT(allocVector(REALSXP, internal->dim_susceptible_child_bearing));
  memcpy(REAL(susceptible_child_bearing), internal->susceptible_child_bearing, internal->dim_susceptible_child_bearing * sizeof(double));
  SET_VECTOR_ELT(contents, 119, susceptible_child_bearing);
  SEXP susceptible_pop = PROTECT(allocVector(REALSXP, internal->dim_susceptible_pop));
  memcpy(REAL(susceptible_pop), internal->susceptible_pop, internal->dim_susceptible_pop * sizeof(double));
  SET_VECTOR_ELT(contents, 120, susceptible_pop);
  SEXP t_death_rate = PROTECT(allocVector(REALSXP, internal->dim_t_death_rate));
  memcpy(REAL(t_death_rate), internal->t_death_rate, internal->dim_t_death_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 121, t_death_rate);
  SEXP t_vaccination_coverage = PROTECT(allocVector(REALSXP, internal->dim_t_vaccination_coverage));
  memcpy(REAL(t_vaccination_coverage), internal->t_vaccination_coverage, internal->dim_t_vaccination_coverage * sizeof(double));
  SET_VECTOR_ELT(contents, 122, t_vaccination_coverage);
  SEXP t_vaccination_partial_coverage = PROTECT(allocVector(REALSXP, internal->dim_t_vaccination_partial_coverage));
  memcpy(REAL(t_vaccination_partial_coverage), internal->t_vaccination_partial_coverage, internal->dim_t_vaccination_partial_coverage * sizeof(double));
  SET_VECTOR_ELT(contents, 123, t_vaccination_partial_coverage);
  SEXP total_child_bearing = PROTECT(allocVector(REALSXP, internal->dim_total_child_bearing));
  memcpy(REAL(total_child_bearing), internal->total_child_bearing, internal->dim_total_child_bearing * sizeof(double));
  SET_VECTOR_ELT(contents, 124, total_child_bearing);
  SEXP total_pop = PROTECT(allocVector(REALSXP, internal->dim_total_pop));
  memcpy(REAL(total_pop), internal->total_pop, internal->dim_total_pop * sizeof(double));
  SET_VECTOR_ELT(contents, 125, total_pop);
  SEXP tt_crude_birth_rate = PROTECT(allocVector(REALSXP, internal->dim_tt_crude_birth_rate));
  memcpy(REAL(tt_crude_birth_rate), internal->tt_crude_birth_rate, internal->dim_tt_crude_birth_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 126, tt_crude_birth_rate);
  SEXP tt_crude_death_rate = PROTECT(allocVector(REALSXP, internal->dim_tt_crude_death_rate));
  memcpy(REAL(tt_crude_death_rate), internal->tt_crude_death_rate, internal->dim_tt_crude_death_rate * sizeof(double));
  SET_VECTOR_ELT(contents, 127, tt_crude_death_rate);
  SEXP tt_crude_foi = PROTECT(allocVector(REALSXP, internal->dim_tt_crude_foi));
  memcpy(REAL(tt_crude_foi), internal->tt_crude_foi, internal->dim_tt_crude_foi * sizeof(double));
  SET_VECTOR_ELT(contents, 128, tt_crude_foi);
  SEXP tt_vaccination_coverage = PROTECT(allocVector(REALSXP, internal->dim_tt_vaccination_coverage));
  memcpy(REAL(tt_vaccination_coverage), internal->tt_vaccination_coverage, internal->dim_tt_vaccination_coverage * sizeof(double));
  SET_VECTOR_ELT(contents, 129, tt_vaccination_coverage);
  SEXP vaccination_coverage = PROTECT(allocVector(REALSXP, internal->dim_vaccination_coverage));
  memcpy(REAL(vaccination_coverage), internal->vaccination_coverage, internal->dim_vaccination_coverage * sizeof(double));
  odin_set_dim(vaccination_coverage, 2, internal->dim_vaccination_coverage_1, internal->dim_vaccination_coverage_2);
  SET_VECTOR_ELT(contents, 130, vaccination_coverage);
  SEXP vaccination_partial_coverage = PROTECT(allocVector(REALSXP, internal->dim_vaccination_partial_coverage));
  memcpy(REAL(vaccination_partial_coverage), internal->vaccination_partial_coverage, internal->dim_vaccination_partial_coverage * sizeof(double));
  odin_set_dim(vaccination_partial_coverage, 2, internal->dim_vaccination_partial_coverage_1, internal->dim_vaccination_partial_coverage_2);
  SET_VECTOR_ELT(contents, 131, vaccination_partial_coverage);
  SET_VECTOR_ELT(contents, 132, ScalarReal(internal->waning));
  SEXP waning_R = PROTECT(allocVector(REALSXP, internal->dim_waning_R));
  memcpy(REAL(waning_R), internal->waning_R, internal->dim_waning_R * sizeof(double));
  SET_VECTOR_ELT(contents, 133, waning_R);
  SEXP waning_V = PROTECT(allocVector(REALSXP, internal->dim_waning_V));
  memcpy(REAL(waning_V), internal->waning_V, internal->dim_waning_V * sizeof(double));
  SET_VECTOR_ELT(contents, 134, waning_V);
  SEXP waning_VD = PROTECT(allocVector(REALSXP, internal->dim_waning_VD));
  memcpy(REAL(waning_VD), internal->waning_VD, internal->dim_waning_VD * sizeof(double));
  SET_VECTOR_ELT(contents, 135, waning_VD);
  SEXP weighted_totals = PROTECT(allocVector(REALSXP, internal->dim_weighted_totals));
  memcpy(REAL(weighted_totals), internal->weighted_totals, internal->dim_weighted_totals * sizeof(double));
  SET_VECTOR_ELT(contents, 136, weighted_totals);
  SEXP nms = PROTECT(allocVector(STRSXP, 137));
  SET_STRING_ELT(nms, 0, mkChar("adjust_for_crude_foi"));
  SET_STRING_ELT(nms, 1, mkChar("age_group_loses_maternal"));
  SET_STRING_ELT(nms, 2, mkChar("age_group_no_maternal"));
  SET_STRING_ELT(nms, 3, mkChar("age_rate"));
  SET_STRING_ELT(nms, 4, mkChar("ageing_M"));
  SET_STRING_ELT(nms, 5, mkChar("ageing_R"));
  SET_STRING_ELT(nms, 6, mkChar("ageing_S"));
  SET_STRING_ELT(nms, 7, mkChar("ageing_V"));
  SET_STRING_ELT(nms, 8, mkChar("ageing_VD"));
  SET_STRING_ELT(nms, 9, mkChar("ages_up_M"));
  SET_STRING_ELT(nms, 10, mkChar("ages_up_M_nv"));
  SET_STRING_ELT(nms, 11, mkChar("ages_up_M_v"));
  SET_STRING_ELT(nms, 12, mkChar("ages_up_R"));
  SET_STRING_ELT(nms, 13, mkChar("ages_up_R_nv"));
  SET_STRING_ELT(nms, 14, mkChar("ages_up_R_v"));
  SET_STRING_ELT(nms, 15, mkChar("ages_up_S"));
  SET_STRING_ELT(nms, 16, mkChar("ages_up_S_nv"));
  SET_STRING_ELT(nms, 17, mkChar("ages_up_S_pv"));
  SET_STRING_ELT(nms, 18, mkChar("ages_up_S_v"));
  SET_STRING_ELT(nms, 19, mkChar("ages_up_V"));
  SET_STRING_ELT(nms, 20, mkChar("ages_up_VD"));
  SET_STRING_ELT(nms, 21, mkChar("ages_up_VD_nv"));
  SET_STRING_ELT(nms, 22, mkChar("ages_up_VD_v"));
  SET_STRING_ELT(nms, 23, mkChar("births_deaths_M"));
  SET_STRING_ELT(nms, 24, mkChar("births_deaths_R"));
  SET_STRING_ELT(nms, 25, mkChar("births_deaths_S"));
  SET_STRING_ELT(nms, 26, mkChar("births_deaths_V"));
  SET_STRING_ELT(nms, 27, mkChar("births_deaths_VD"));
  SET_STRING_ELT(nms, 28, mkChar("child_bearing"));
  SET_STRING_ELT(nms, 29, mkChar("crude_birth_rate"));
  SET_STRING_ELT(nms, 30, mkChar("crude_death_rate"));
  SET_STRING_ELT(nms, 31, mkChar("crude_foi"));
  SET_STRING_ELT(nms, 32, mkChar("dim_age_rate"));
  SET_STRING_ELT(nms, 33, mkChar("dim_ageing_M"));
  SET_STRING_ELT(nms, 34, mkChar("dim_ageing_R"));
  SET_STRING_ELT(nms, 35, mkChar("dim_ageing_S"));
  SET_STRING_ELT(nms, 36, mkChar("dim_ageing_V"));
  SET_STRING_ELT(nms, 37, mkChar("dim_ageing_VD"));
  SET_STRING_ELT(nms, 38, mkChar("dim_ages_up_M"));
  SET_STRING_ELT(nms, 39, mkChar("dim_ages_up_M_nv"));
  SET_STRING_ELT(nms, 40, mkChar("dim_ages_up_M_v"));
  SET_STRING_ELT(nms, 41, mkChar("dim_ages_up_R"));
  SET_STRING_ELT(nms, 42, mkChar("dim_ages_up_R_nv"));
  SET_STRING_ELT(nms, 43, mkChar("dim_ages_up_R_v"));
  SET_STRING_ELT(nms, 44, mkChar("dim_ages_up_S"));
  SET_STRING_ELT(nms, 45, mkChar("dim_ages_up_S_nv"));
  SET_STRING_ELT(nms, 46, mkChar("dim_ages_up_S_pv"));
  SET_STRING_ELT(nms, 47, mkChar("dim_ages_up_S_v"));
  SET_STRING_ELT(nms, 48, mkChar("dim_ages_up_V"));
  SET_STRING_ELT(nms, 49, mkChar("dim_ages_up_VD"));
  SET_STRING_ELT(nms, 50, mkChar("dim_ages_up_VD_nv"));
  SET_STRING_ELT(nms, 51, mkChar("dim_ages_up_VD_v"));
  SET_STRING_ELT(nms, 52, mkChar("dim_births_deaths_M"));
  SET_STRING_ELT(nms, 53, mkChar("dim_births_deaths_R"));
  SET_STRING_ELT(nms, 54, mkChar("dim_births_deaths_S"));
  SET_STRING_ELT(nms, 55, mkChar("dim_births_deaths_V"));
  SET_STRING_ELT(nms, 56, mkChar("dim_births_deaths_VD"));
  SET_STRING_ELT(nms, 57, mkChar("dim_child_bearing"));
  SET_STRING_ELT(nms, 58, mkChar("dim_crude_birth_rate"));
  SET_STRING_ELT(nms, 59, mkChar("dim_crude_death_rate"));
  SET_STRING_ELT(nms, 60, mkChar("dim_crude_foi"));
  SET_STRING_ELT(nms, 61, mkChar("dim_gains_immunity"));
  SET_STRING_ELT(nms, 62, mkChar("dim_infections_S"));
  SET_STRING_ELT(nms, 63, mkChar("dim_infections_VD"));
  SET_STRING_ELT(nms, 64, mkChar("dim_loses_immunity"));
  SET_STRING_ELT(nms, 65, mkChar("dim_M"));
  SET_STRING_ELT(nms, 66, mkChar("dim_M_0"));
  SET_STRING_ELT(nms, 67, mkChar("dim_prop_death"));
  SET_STRING_ELT(nms, 68, mkChar("dim_R"));
  SET_STRING_ELT(nms, 69, mkChar("dim_R_0"));
  SET_STRING_ELT(nms, 70, mkChar("dim_S"));
  SET_STRING_ELT(nms, 71, mkChar("dim_S_0"));
  SET_STRING_ELT(nms, 72, mkChar("dim_susceptible_child_bearing"));
  SET_STRING_ELT(nms, 73, mkChar("dim_susceptible_pop"));
  SET_STRING_ELT(nms, 74, mkChar("dim_t_death_rate"));
  SET_STRING_ELT(nms, 75, mkChar("dim_t_vaccination_coverage"));
  SET_STRING_ELT(nms, 76, mkChar("dim_t_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 77, mkChar("dim_total_child_bearing"));
  SET_STRING_ELT(nms, 78, mkChar("dim_total_pop"));
  SET_STRING_ELT(nms, 79, mkChar("dim_tt_crude_birth_rate"));
  SET_STRING_ELT(nms, 80, mkChar("dim_tt_crude_death_rate"));
  SET_STRING_ELT(nms, 81, mkChar("dim_tt_crude_foi"));
  SET_STRING_ELT(nms, 82, mkChar("dim_tt_vaccination_coverage"));
  SET_STRING_ELT(nms, 83, mkChar("dim_V"));
  SET_STRING_ELT(nms, 84, mkChar("dim_vaccination_coverage"));
  SET_STRING_ELT(nms, 85, mkChar("dim_vaccination_coverage_1"));
  SET_STRING_ELT(nms, 86, mkChar("dim_vaccination_coverage_2"));
  SET_STRING_ELT(nms, 87, mkChar("dim_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 88, mkChar("dim_vaccination_partial_coverage_1"));
  SET_STRING_ELT(nms, 89, mkChar("dim_vaccination_partial_coverage_2"));
  SET_STRING_ELT(nms, 90, mkChar("dim_VD"));
  SET_STRING_ELT(nms, 91, mkChar("dim_waning_R"));
  SET_STRING_ELT(nms, 92, mkChar("dim_waning_V"));
  SET_STRING_ELT(nms, 93, mkChar("dim_waning_VD"));
  SET_STRING_ELT(nms, 94, mkChar("dim_weighted_totals"));
  SET_STRING_ELT(nms, 95, mkChar("gains_immunity"));
  SET_STRING_ELT(nms, 96, mkChar("infections_S"));
  SET_STRING_ELT(nms, 97, mkChar("infections_VD"));
  SET_STRING_ELT(nms, 98, mkChar("initial_M"));
  SET_STRING_ELT(nms, 99, mkChar("initial_R"));
  SET_STRING_ELT(nms, 100, mkChar("initial_S"));
  SET_STRING_ELT(nms, 101, mkChar("initial_V"));
  SET_STRING_ELT(nms, 102, mkChar("initial_VD"));
  SET_STRING_ELT(nms, 103, mkChar("interpolate_t_crude_birth_rate"));
  SET_STRING_ELT(nms, 104, mkChar("interpolate_t_crude_death_rate"));
  SET_STRING_ELT(nms, 105, mkChar("interpolate_t_crude_foi"));
  SET_STRING_ELT(nms, 106, mkChar("interpolate_t_vaccination_coverage"));
  SET_STRING_ELT(nms, 107, mkChar("interpolate_t_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 108, mkChar("loses_immunity"));
  SET_STRING_ELT(nms, 109, mkChar("M_0"));
  SET_STRING_ELT(nms, 110, mkChar("n_age"));
  SET_STRING_ELT(nms, 111, mkChar("n_age_penultimate"));
  SET_STRING_ELT(nms, 112, mkChar("n_maternal"));
  SET_STRING_ELT(nms, 113, mkChar("offset_variable_M"));
  SET_STRING_ELT(nms, 114, mkChar("offset_variable_V"));
  SET_STRING_ELT(nms, 115, mkChar("offset_variable_VD"));
  SET_STRING_ELT(nms, 116, mkChar("prop_death"));
  SET_STRING_ELT(nms, 117, mkChar("R_0"));
  SET_STRING_ELT(nms, 118, mkChar("S_0"));
  SET_STRING_ELT(nms, 119, mkChar("susceptible_child_bearing"));
  SET_STRING_ELT(nms, 120, mkChar("susceptible_pop"));
  SET_STRING_ELT(nms, 121, mkChar("t_death_rate"));
  SET_STRING_ELT(nms, 122, mkChar("t_vaccination_coverage"));
  SET_STRING_ELT(nms, 123, mkChar("t_vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 124, mkChar("total_child_bearing"));
  SET_STRING_ELT(nms, 125, mkChar("total_pop"));
  SET_STRING_ELT(nms, 126, mkChar("tt_crude_birth_rate"));
  SET_STRING_ELT(nms, 127, mkChar("tt_crude_death_rate"));
  SET_STRING_ELT(nms, 128, mkChar("tt_crude_foi"));
  SET_STRING_ELT(nms, 129, mkChar("tt_vaccination_coverage"));
  SET_STRING_ELT(nms, 130, mkChar("vaccination_coverage"));
  SET_STRING_ELT(nms, 131, mkChar("vaccination_partial_coverage"));
  SET_STRING_ELT(nms, 132, mkChar("waning"));
  SET_STRING_ELT(nms, 133, mkChar("waning_R"));
  SET_STRING_ELT(nms, 134, mkChar("waning_V"));
  SET_STRING_ELT(nms, 135, mkChar("waning_VD"));
  SET_STRING_ELT(nms, 136, mkChar("weighted_totals"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(61);
  return contents;
}
SEXP static_model_set_user(SEXP internal_p, SEXP user) {
  static_model_internal *internal = static_model_get_internal(internal_p, 1);
  internal->adjust_for_crude_foi = user_get_scalar_double(user, "adjust_for_crude_foi", internal->adjust_for_crude_foi, NA_REAL, NA_REAL);
  internal->n_age = user_get_scalar_int(user, "n_age", internal->n_age, NA_REAL, NA_REAL);
  internal->n_maternal = user_get_scalar_int(user, "n_maternal", internal->n_maternal, NA_REAL, NA_REAL);
  internal->tt_crude_birth_rate = (double*) user_get_array_dim(user, false, internal->tt_crude_birth_rate, "tt_crude_birth_rate", 1, NA_REAL, NA_REAL, &internal->dim_tt_crude_birth_rate);
  internal->tt_crude_death_rate = (double*) user_get_array_dim(user, false, internal->tt_crude_death_rate, "tt_crude_death_rate", 1, NA_REAL, NA_REAL, &internal->dim_tt_crude_death_rate);
  internal->tt_crude_foi = (double*) user_get_array_dim(user, false, internal->tt_crude_foi, "tt_crude_foi", 1, NA_REAL, NA_REAL, &internal->dim_tt_crude_foi);
  internal->tt_vaccination_coverage = (double*) user_get_array_dim(user, false, internal->tt_vaccination_coverage, "tt_vaccination_coverage", 1, NA_REAL, NA_REAL, &internal->dim_tt_vaccination_coverage);
  internal->waning = user_get_scalar_double(user, "waning", internal->waning, NA_REAL, NA_REAL);
  internal->age_group_loses_maternal = internal->n_maternal + 1;
  internal->dim_age_rate = internal->n_age;
  internal->dim_ageing_M = internal->n_maternal;
  internal->dim_ageing_R = internal->n_age;
  internal->dim_ageing_S = internal->n_age;
  internal->dim_ageing_V = internal->n_age;
  internal->dim_ageing_VD = internal->n_age;
  internal->dim_ages_up_M = internal->n_maternal;
  internal->dim_ages_up_M_nv = internal->n_maternal;
  internal->dim_ages_up_M_v = internal->n_maternal;
  internal->dim_ages_up_R = internal->n_age;
  internal->dim_ages_up_R_nv = internal->n_age;
  internal->dim_ages_up_R_v = internal->n_age;
  internal->dim_ages_up_S = internal->n_age;
  internal->dim_ages_up_S_nv = internal->n_age;
  internal->dim_ages_up_S_pv = internal->n_age;
  internal->dim_ages_up_S_v = internal->n_age;
  internal->dim_ages_up_V = internal->n_age;
  internal->dim_ages_up_VD = internal->n_age;
  internal->dim_ages_up_VD_nv = internal->n_age;
  internal->dim_ages_up_VD_v = internal->n_age;
  internal->dim_births_deaths_M = internal->n_maternal;
  internal->dim_births_deaths_R = internal->n_age;
  internal->dim_births_deaths_S = internal->n_age;
  internal->dim_births_deaths_V = internal->n_age;
  internal->dim_births_deaths_VD = internal->n_age;
  internal->dim_child_bearing = internal->n_age;
  internal->dim_gains_immunity = internal->n_age;
  internal->dim_infections_S = internal->n_age;
  internal->dim_infections_VD = internal->n_age;
  internal->dim_loses_immunity = internal->n_age;
  internal->dim_M = internal->n_maternal;
  internal->dim_M_0 = internal->n_maternal;
  internal->dim_prop_death = internal->n_age;
  internal->dim_R = internal->n_age;
  internal->dim_R_0 = internal->n_age;
  internal->dim_S = internal->n_age;
  internal->dim_S_0 = internal->n_age;
  internal->dim_susceptible_child_bearing = internal->n_age;
  internal->dim_susceptible_pop = internal->n_age;
  internal->dim_t_death_rate = internal->n_age;
  internal->dim_t_vaccination_coverage = internal->n_age;
  internal->dim_t_vaccination_partial_coverage = internal->n_age;
  internal->dim_total_child_bearing = internal->n_age;
  internal->dim_total_pop = internal->n_age;
  internal->dim_V = internal->n_age;
  internal->dim_VD = internal->n_age;
  internal->dim_waning_R = internal->n_age;
  internal->dim_waning_V = internal->n_age;
  internal->dim_waning_VD = internal->n_age;
  internal->dim_weighted_totals = internal->n_age;
  internal->n_age_penultimate = internal->n_age - 1;
  internal->age_group_no_maternal = internal->age_group_loses_maternal + 1;
  internal->age_rate = (double*) user_get_array(user, false, internal->age_rate, "age_rate", NA_REAL, NA_REAL, 1, internal->dim_age_rate);
  R_Free(internal->ageing_M);
  internal->ageing_M = (double*) R_Calloc(internal->dim_ageing_M, double);
  R_Free(internal->ageing_R);
  internal->ageing_R = (double*) R_Calloc(internal->dim_ageing_R, double);
  R_Free(internal->ageing_S);
  internal->ageing_S = (double*) R_Calloc(internal->dim_ageing_S, double);
  R_Free(internal->ageing_V);
  internal->ageing_V = (double*) R_Calloc(internal->dim_ageing_V, double);
  R_Free(internal->ageing_VD);
  internal->ageing_VD = (double*) R_Calloc(internal->dim_ageing_VD, double);
  R_Free(internal->ages_up_M);
  internal->ages_up_M = (double*) R_Calloc(internal->dim_ages_up_M, double);
  R_Free(internal->ages_up_M_nv);
  internal->ages_up_M_nv = (double*) R_Calloc(internal->dim_ages_up_M_nv, double);
  R_Free(internal->ages_up_M_v);
  internal->ages_up_M_v = (double*) R_Calloc(internal->dim_ages_up_M_v, double);
  R_Free(internal->ages_up_R);
  internal->ages_up_R = (double*) R_Calloc(internal->dim_ages_up_R, double);
  R_Free(internal->ages_up_R_nv);
  internal->ages_up_R_nv = (double*) R_Calloc(internal->dim_ages_up_R_nv, double);
  R_Free(internal->ages_up_R_v);
  internal->ages_up_R_v = (double*) R_Calloc(internal->dim_ages_up_R_v, double);
  R_Free(internal->ages_up_S);
  internal->ages_up_S = (double*) R_Calloc(internal->dim_ages_up_S, double);
  R_Free(internal->ages_up_S_nv);
  internal->ages_up_S_nv = (double*) R_Calloc(internal->dim_ages_up_S_nv, double);
  R_Free(internal->ages_up_S_pv);
  internal->ages_up_S_pv = (double*) R_Calloc(internal->dim_ages_up_S_pv, double);
  R_Free(internal->ages_up_S_v);
  internal->ages_up_S_v = (double*) R_Calloc(internal->dim_ages_up_S_v, double);
  R_Free(internal->ages_up_V);
  internal->ages_up_V = (double*) R_Calloc(internal->dim_ages_up_V, double);
  R_Free(internal->ages_up_VD);
  internal->ages_up_VD = (double*) R_Calloc(internal->dim_ages_up_VD, double);
  R_Free(internal->ages_up_VD_nv);
  internal->ages_up_VD_nv = (double*) R_Calloc(internal->dim_ages_up_VD_nv, double);
  R_Free(internal->ages_up_VD_v);
  internal->ages_up_VD_v = (double*) R_Calloc(internal->dim_ages_up_VD_v, double);
  R_Free(internal->births_deaths_M);
  internal->births_deaths_M = (double*) R_Calloc(internal->dim_births_deaths_M, double);
  R_Free(internal->births_deaths_R);
  internal->births_deaths_R = (double*) R_Calloc(internal->dim_births_deaths_R, double);
  R_Free(internal->births_deaths_S);
  internal->births_deaths_S = (double*) R_Calloc(internal->dim_births_deaths_S, double);
  R_Free(internal->births_deaths_V);
  internal->births_deaths_V = (double*) R_Calloc(internal->dim_births_deaths_V, double);
  R_Free(internal->births_deaths_VD);
  internal->births_deaths_VD = (double*) R_Calloc(internal->dim_births_deaths_VD, double);
  R_Free(internal->gains_immunity);
  internal->gains_immunity = (double*) R_Calloc(internal->dim_gains_immunity, double);
  R_Free(internal->infections_S);
  internal->infections_S = (double*) R_Calloc(internal->dim_infections_S, double);
  R_Free(internal->infections_VD);
  internal->infections_VD = (double*) R_Calloc(internal->dim_infections_VD, double);
  R_Free(internal->initial_M);
  internal->initial_M = (double*) R_Calloc(internal->dim_M, double);
  R_Free(internal->initial_R);
  internal->initial_R = (double*) R_Calloc(internal->dim_R, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_V);
  internal->initial_V = (double*) R_Calloc(internal->dim_V, double);
  R_Free(internal->initial_VD);
  internal->initial_VD = (double*) R_Calloc(internal->dim_VD, double);
  R_Free(internal->loses_immunity);
  internal->loses_immunity = (double*) R_Calloc(internal->dim_loses_immunity, double);
  R_Free(internal->susceptible_child_bearing);
  internal->susceptible_child_bearing = (double*) R_Calloc(internal->dim_susceptible_child_bearing, double);
  R_Free(internal->susceptible_pop);
  internal->susceptible_pop = (double*) R_Calloc(internal->dim_susceptible_pop, double);
  R_Free(internal->t_death_rate);
  internal->t_death_rate = (double*) R_Calloc(internal->dim_t_death_rate, double);
  R_Free(internal->t_vaccination_coverage);
  internal->t_vaccination_coverage = (double*) R_Calloc(internal->dim_t_vaccination_coverage, double);
  R_Free(internal->t_vaccination_partial_coverage);
  internal->t_vaccination_partial_coverage = (double*) R_Calloc(internal->dim_t_vaccination_partial_coverage, double);
  R_Free(internal->total_child_bearing);
  internal->total_child_bearing = (double*) R_Calloc(internal->dim_total_child_bearing, double);
  R_Free(internal->total_pop);
  internal->total_pop = (double*) R_Calloc(internal->dim_total_pop, double);
  R_Free(internal->waning_R);
  internal->waning_R = (double*) R_Calloc(internal->dim_waning_R, double);
  R_Free(internal->waning_V);
  internal->waning_V = (double*) R_Calloc(internal->dim_waning_V, double);
  R_Free(internal->waning_VD);
  internal->waning_VD = (double*) R_Calloc(internal->dim_waning_VD, double);
  R_Free(internal->weighted_totals);
  internal->weighted_totals = (double*) R_Calloc(internal->dim_weighted_totals, double);
  internal->child_bearing = (double*) user_get_array(user, false, internal->child_bearing, "child_bearing", NA_REAL, NA_REAL, 1, internal->dim_child_bearing);
  internal->dim_crude_birth_rate = internal->dim_tt_crude_birth_rate;
  internal->dim_crude_death_rate = internal->dim_tt_crude_death_rate;
  internal->dim_crude_foi = internal->dim_tt_crude_foi;
  internal->dim_vaccination_coverage_1 = internal->dim_tt_vaccination_coverage;
  internal->dim_vaccination_coverage_2 = internal->n_age;
  internal->dim_vaccination_partial_coverage_1 = internal->dim_tt_vaccination_coverage;
  internal->dim_vaccination_partial_coverage_2 = internal->n_age;
  for (int i = 1; i <= internal->dim_V; ++i) {
    internal->initial_V[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_VD; ++i) {
    internal->initial_VD[i - 1] = 0;
  }
  internal->M_0 = (double*) user_get_array(user, false, internal->M_0, "M_0", NA_REAL, NA_REAL, 1, internal->dim_M_0);
  internal->offset_variable_M = internal->dim_R + internal->dim_S + internal->dim_V + internal->dim_VD;
  internal->offset_variable_V = internal->dim_R + internal->dim_S;
  internal->offset_variable_VD = internal->dim_R + internal->dim_S + internal->dim_V;
  internal->prop_death = (double*) user_get_array(user, false, internal->prop_death, "prop_death", NA_REAL, NA_REAL, 1, internal->dim_prop_death);
  internal->R_0 = (double*) user_get_array(user, false, internal->R_0, "R_0", NA_REAL, NA_REAL, 1, internal->dim_R_0);
  internal->S_0 = (double*) user_get_array(user, false, internal->S_0, "S_0", NA_REAL, NA_REAL, 1, internal->dim_S_0);
  internal->crude_birth_rate = (double*) user_get_array(user, false, internal->crude_birth_rate, "crude_birth_rate", NA_REAL, NA_REAL, 1, internal->dim_crude_birth_rate);
  internal->crude_death_rate = (double*) user_get_array(user, false, internal->crude_death_rate, "crude_death_rate", NA_REAL, NA_REAL, 1, internal->dim_crude_death_rate);
  internal->crude_foi = (double*) user_get_array(user, false, internal->crude_foi, "crude_foi", NA_REAL, NA_REAL, 1, internal->dim_crude_foi);
  internal->dim_vaccination_coverage = internal->dim_vaccination_coverage_1 * internal->dim_vaccination_coverage_2;
  internal->dim_vaccination_partial_coverage = internal->dim_vaccination_partial_coverage_1 * internal->dim_vaccination_partial_coverage_2;
  for (int i = 1; i <= internal->dim_M; ++i) {
    internal->initial_M[i - 1] = internal->M_0[i - 1];
  }
  for (int i = 1; i <= internal->dim_R; ++i) {
    internal->initial_R[i - 1] = internal->R_0[i - 1];
  }
  for (int i = 1; i <= internal->dim_S; ++i) {
    internal->initial_S[i - 1] = internal->S_0[i - 1];
  }
  interpolate_check_y(internal->dim_tt_crude_birth_rate, internal->dim_crude_birth_rate, 0, "crude_birth_rate", "t_crude_birth_rate");
  cinterpolate_free(internal->interpolate_t_crude_birth_rate);
  internal->interpolate_t_crude_birth_rate = cinterpolate_alloc("constant", internal->dim_tt_crude_birth_rate, 1, internal->tt_crude_birth_rate, internal->crude_birth_rate, true, false);
  interpolate_check_y(internal->dim_tt_crude_death_rate, internal->dim_crude_death_rate, 0, "crude_death_rate", "t_crude_death_rate");
  cinterpolate_free(internal->interpolate_t_crude_death_rate);
  internal->interpolate_t_crude_death_rate = cinterpolate_alloc("constant", internal->dim_tt_crude_death_rate, 1, internal->tt_crude_death_rate, internal->crude_death_rate, true, false);
  interpolate_check_y(internal->dim_tt_crude_foi, internal->dim_crude_foi, 0, "crude_foi", "t_crude_foi");
  cinterpolate_free(internal->interpolate_t_crude_foi);
  internal->interpolate_t_crude_foi = cinterpolate_alloc("constant", internal->dim_tt_crude_foi, 1, internal->tt_crude_foi, internal->crude_foi, true, false);
  internal->vaccination_coverage = (double*) user_get_array(user, false, internal->vaccination_coverage, "vaccination_coverage", NA_REAL, NA_REAL, 2, internal->dim_vaccination_coverage_1, internal->dim_vaccination_coverage_2);
  internal->vaccination_partial_coverage = (double*) user_get_array(user, false, internal->vaccination_partial_coverage, "vaccination_partial_coverage", NA_REAL, NA_REAL, 2, internal->dim_vaccination_partial_coverage_1, internal->dim_vaccination_partial_coverage_2);
  interpolate_check_y(internal->dim_tt_vaccination_coverage, internal->dim_vaccination_coverage_1, 1, "vaccination_coverage", "t_vaccination_coverage");
  interpolate_check_y(internal->dim_t_vaccination_coverage, internal->dim_vaccination_coverage_2, 2, "vaccination_coverage", "t_vaccination_coverage");
  cinterpolate_free(internal->interpolate_t_vaccination_coverage);
  internal->interpolate_t_vaccination_coverage = cinterpolate_alloc("constant", internal->dim_tt_vaccination_coverage, internal->dim_t_vaccination_coverage, internal->tt_vaccination_coverage, internal->vaccination_coverage, true, false);
  interpolate_check_y(internal->dim_tt_vaccination_coverage, internal->dim_vaccination_partial_coverage_1, 1, "vaccination_partial_coverage", "t_vaccination_partial_coverage");
  interpolate_check_y(internal->dim_t_vaccination_partial_coverage, internal->dim_vaccination_partial_coverage_2, 2, "vaccination_partial_coverage", "t_vaccination_partial_coverage");
  cinterpolate_free(internal->interpolate_t_vaccination_partial_coverage);
  internal->interpolate_t_vaccination_partial_coverage = cinterpolate_alloc("constant", internal->dim_tt_vaccination_coverage, internal->dim_t_vaccination_partial_coverage, internal->tt_vaccination_coverage, internal->vaccination_partial_coverage, true, false);
  return R_NilValue;
}
SEXP static_model_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP static_model_use_dde_ptr) {
  return R_NilValue;
}
SEXP static_model_metadata(SEXP internal_p) {
  static_model_internal *internal = static_model_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 5));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 5));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(variable_length, 1, ScalarInteger(internal->dim_R));
  SET_VECTOR_ELT(variable_length, 2, ScalarInteger(internal->dim_V));
  SET_VECTOR_ELT(variable_length, 3, ScalarInteger(internal->dim_VD));
  SET_VECTOR_ELT(variable_length, 4, ScalarInteger(internal->dim_M));
  SET_STRING_ELT(variable_names, 0, mkChar("S"));
  SET_STRING_ELT(variable_names, 1, mkChar("R"));
  SET_STRING_ELT(variable_names, 2, mkChar("V"));
  SET_STRING_ELT(variable_names, 3, mkChar("VD"));
  SET_STRING_ELT(variable_names, 4, mkChar("M"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 1, R_NilValue);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(0));
  SEXP interpolate_t = PROTECT(allocVector(VECSXP, 3));
  SEXP interpolate_t_nms = PROTECT(allocVector(STRSXP, 3));
  setAttrib(interpolate_t, R_NamesSymbol, interpolate_t_nms);
  SET_VECTOR_ELT(interpolate_t, 0, ScalarReal(fmax(internal->tt_crude_birth_rate[0], fmax(internal->tt_crude_death_rate[0], fmax(internal->tt_crude_foi[0], internal->tt_vaccination_coverage[0])))));
  SET_VECTOR_ELT(interpolate_t, 1, ScalarReal(R_PosInf));
  SET_STRING_ELT(interpolate_t_nms, 0, mkChar("min"));
  SET_STRING_ELT(interpolate_t_nms, 1, mkChar("max"));
  SET_VECTOR_ELT(ret, 3, interpolate_t);
  UNPROTECT(2);
  UNPROTECT(2);
  return ret;
}
SEXP static_model_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  static_model_internal *internal = static_model_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_M + internal->dim_R + internal->dim_S + internal->dim_V + internal->dim_VD));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->dim_S, internal->initial_R, internal->dim_R * sizeof(double));
  memcpy(state + internal->offset_variable_V, internal->initial_V, internal->dim_V * sizeof(double));
  memcpy(state + internal->offset_variable_VD, internal->initial_VD, internal->dim_VD * sizeof(double));
  memcpy(state + internal->offset_variable_M, internal->initial_M, internal->dim_M * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void static_model_rhs(static_model_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * S = state + 0;
  double * R = state + internal->dim_S;
  double * V = state + internal->offset_variable_V;
  double * VD = state + internal->offset_variable_VD;
  double * M = state + internal->offset_variable_M;
  for (int i = 1; i <= internal->dim_ages_up_M; ++i) {
    internal->ages_up_M[i - 1] = M[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_R; ++i) {
    internal->ages_up_R[i - 1] = R[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S; ++i) {
    internal->ages_up_S[i - 1] = S[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_V; ++i) {
    internal->ages_up_V[i - 1] = V[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_VD; ++i) {
    internal->ages_up_VD[i - 1] = VD[i - 1] * internal->age_rate[i - 1];
  }
  for (int i = 1; i <= internal->dim_susceptible_pop; ++i) {
    internal->susceptible_pop[i - 1] = S[i - 1] + VD[i - 1];
  }
  for (int i = 1; i <= internal->n_maternal; ++i) {
    internal->total_pop[i - 1] = R[i - 1] + S[i - 1] + V[i - 1] + M[i - 1] + VD[i - 1];
  }
  for (int i = (internal->n_maternal + 1); i <= internal->n_age; ++i) {
    internal->total_pop[i - 1] = R[i - 1] + S[i - 1] + V[i - 1] + VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_waning_R; ++i) {
    internal->waning_R[i - 1] = internal->waning * R[i - 1];
  }
  for (int i = 1; i <= internal->dim_waning_V; ++i) {
    internal->waning_V[i - 1] = internal->waning * V[i - 1];
  }
  for (int i = 1; i <= internal->dim_waning_VD; ++i) {
    internal->waning_VD[i - 1] = internal->waning * VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_loses_immunity; ++i) {
    internal->loses_immunity[i - 1] = internal->waning_R[i - 1] + internal->waning_V[i - 1] + internal->waning_VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_susceptible_child_bearing; ++i) {
    internal->susceptible_child_bearing[i - 1] = (internal->susceptible_pop[i - 1]) * internal->child_bearing[i - 1];
  }
  for (int i = 1; i <= internal->dim_total_child_bearing; ++i) {
    internal->total_child_bearing[i - 1] = internal->total_pop[i - 1] * internal->child_bearing[i - 1];
  }
  for (int i = 1; i <= internal->dim_weighted_totals; ++i) {
    internal->weighted_totals[i - 1] = internal->prop_death[i - 1] * internal->total_pop[i - 1];
  }
  double t_crude_birth_rate = 0.0;
  cinterpolate_eval(t, internal->interpolate_t_crude_birth_rate, &t_crude_birth_rate);
  double t_crude_death_rate = 0.0;
  cinterpolate_eval(t, internal->interpolate_t_crude_death_rate, &t_crude_death_rate);
  double t_crude_foi = 0.0;
  cinterpolate_eval(t, internal->interpolate_t_crude_foi, &t_crude_foi);
  double births_total = (odin_sum1(internal->total_pop, 0, internal->dim_total_pop)) * t_crude_birth_rate;
  double t_adjusted_foi = (internal->adjust_for_crude_foi ? fmin(t_crude_foi * odin_sum1(internal->total_pop, 0, internal->dim_total_pop) / (double) odin_sum1(internal->susceptible_pop, 0, internal->dim_susceptible_pop), 1) : t_crude_foi);
  for (int i = 1; i <= internal->dim_t_death_rate; ++i) {
    internal->t_death_rate[i - 1] = fmin(t_crude_death_rate * internal->prop_death[i - 1] * odin_sum1(internal->total_pop, 0, internal->dim_total_pop) / (double) odin_sum1(internal->weighted_totals, 0, internal->dim_weighted_totals), 1);
  }
  cinterpolate_eval(t, internal->interpolate_t_vaccination_coverage, internal->t_vaccination_coverage);
  cinterpolate_eval(t, internal->interpolate_t_vaccination_partial_coverage, internal->t_vaccination_partial_coverage);
  for (int i = 1; i <= internal->dim_ages_up_M_v; ++i) {
    internal->ages_up_M_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_M[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_R_v; ++i) {
    internal->ages_up_R_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_R[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S_pv; ++i) {
    internal->ages_up_S_pv[i - 1] = internal->t_vaccination_partial_coverage[i - 1] * internal->ages_up_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S_v; ++i) {
    internal->ages_up_S_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_VD_v; ++i) {
    internal->ages_up_VD_v[i - 1] = internal->t_vaccination_coverage[i - 1] * internal->ages_up_VD[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_R; ++i) {
    internal->births_deaths_R[i - 1] = -(internal->t_death_rate[i - 1]) * R[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_V; ++i) {
    internal->births_deaths_V[i - 1] = -(internal->t_death_rate[i - 1]) * V[i - 1];
  }
  for (int i = 1; i <= internal->dim_births_deaths_VD; ++i) {
    internal->births_deaths_VD[i - 1] = -(internal->t_death_rate[i - 1]) * VD[i - 1];
  }
  double births_S = births_total * (odin_sum1(internal->susceptible_child_bearing, 0, internal->dim_susceptible_child_bearing) / (double) odin_sum1(internal->total_child_bearing, 0, internal->dim_total_child_bearing));
  for (int i = 1; i <= internal->dim_infections_S; ++i) {
    internal->infections_S[i - 1] = t_adjusted_foi * S[i - 1];
  }
  for (int i = 1; i <= internal->dim_infections_VD; ++i) {
    internal->infections_VD[i - 1] = t_adjusted_foi * VD[i - 1];
  }
  {
     int i = 1;
     internal->ageing_V[i - 1] = -(internal->ages_up_V[i - 1]);
  }
  for (int i = 2; i <= internal->age_group_loses_maternal; ++i) {
    internal->ageing_V[i - 1] = internal->ages_up_M_v[i - 1 - 1] + internal->ages_up_V[i - 1 - 1] + internal->ages_up_S_v[i - 1 - 1] + internal->ages_up_R_v[i - 1 - 1] + internal->ages_up_VD_v[i - 1 - 1] - internal->ages_up_V[i - 1];
  }
  for (int i = internal->age_group_no_maternal; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_V[i - 1] = internal->ages_up_V[i - 1 - 1] + internal->ages_up_S_v[i - 1 - 1] + internal->ages_up_R_v[i - 1 - 1] + internal->ages_up_VD_v[i - 1 - 1] - internal->ages_up_V[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_V[i - 1] = internal->ages_up_V[i - 1 - 1] + internal->ages_up_S_v[i - 1 - 1] + internal->ages_up_R_v[i - 1 - 1] + internal->ages_up_VD_v[i - 1 - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_M_nv; ++i) {
    internal->ages_up_M_nv[i - 1] = internal->ages_up_M[i - 1] - internal->ages_up_M_v[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_R_nv; ++i) {
    internal->ages_up_R_nv[i - 1] = internal->ages_up_R[i - 1] - internal->ages_up_R_v[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_S_nv; ++i) {
    internal->ages_up_S_nv[i - 1] = internal->ages_up_S[i - 1] - internal->ages_up_S_v[i - 1] - internal->ages_up_S_pv[i - 1];
  }
  for (int i = 1; i <= internal->dim_ages_up_VD_nv; ++i) {
    internal->ages_up_VD_nv[i - 1] = internal->ages_up_VD[i - 1] - internal->ages_up_VD_v[i - 1];
  }
  {
     int i = 1;
     internal->births_deaths_S[i - 1] = births_S - internal->t_death_rate[i - 1] * S[i - 1];
  }
  for (int i = 2; i <= internal->n_age; ++i) {
    internal->births_deaths_S[i - 1] = -(internal->t_death_rate[i - 1]) * S[i - 1];
  }
  double births_M = births_total - births_S;
  for (int i = 1; i <= internal->dim_gains_immunity; ++i) {
    internal->gains_immunity[i - 1] = internal->infections_S[i - 1] + internal->infections_VD[i - 1];
  }
  {
     int i = 1;
     internal->ageing_M[i - 1] = -(internal->ages_up_M[i - 1]);
  }
  for (int i = 2; i <= internal->n_maternal; ++i) {
    internal->ageing_M[i - 1] = internal->ages_up_M_nv[i - 1 - 1] - internal->ages_up_M[i - 1];
  }
  {
     int i = 1;
     internal->ageing_R[i - 1] = -(internal->ages_up_R[i - 1]);
  }
  for (int i = 2; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_R[i - 1] = internal->ages_up_R_nv[i - 1 - 1] - internal->ages_up_R[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_R[i - 1] = internal->ages_up_R_nv[i - 1 - 1];
  }
  {
     int i = 1;
     internal->ageing_S[i - 1] = -(internal->ages_up_S[i - 1]);
  }
  for (int i = 2; i <= internal->n_maternal; ++i) {
    internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1] - internal->ages_up_S[i - 1];
  }
  {
     int i = internal->age_group_loses_maternal;
     internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1] + internal->ages_up_M_nv[i - 1 - 1] - internal->ages_up_S[i - 1];
  }
  for (int i = internal->age_group_no_maternal; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1] - internal->ages_up_S[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_S[i - 1] = internal->ages_up_S_nv[i - 1 - 1];
  }
  {
     int i = 1;
     internal->ageing_VD[i - 1] = -(internal->ages_up_VD[i - 1]);
  }
  for (int i = 2; i <= internal->n_age_penultimate; ++i) {
    internal->ageing_VD[i - 1] = internal->ages_up_VD_nv[i - 1 - 1] + internal->ages_up_S_pv[i - 1 - 1] - internal->ages_up_VD[i - 1];
  }
  {
     int i = internal->n_age;
     internal->ageing_VD[i - 1] = internal->ages_up_VD_nv[i - 1 - 1] + internal->ages_up_S_pv[i - 1 - 1];
  }
  {
     int i = 1;
     internal->births_deaths_M[i - 1] = births_M - internal->t_death_rate[i - 1] * M[i - 1];
  }
  for (int i = 2; i <= internal->n_maternal; ++i) {
    internal->births_deaths_M[i - 1] = -(internal->t_death_rate[i - 1]) * M[i - 1];
  }
  for (int i = 1; i <= internal->dim_V; ++i) {
    dstatedt[internal->offset_variable_V + i - 1] = internal->births_deaths_V[i - 1] + internal->ageing_V[i - 1] - internal->waning_V[i - 1];
  }
  for (int i = 1; i <= internal->dim_M; ++i) {
    dstatedt[internal->offset_variable_M + i - 1] = internal->births_deaths_M[i - 1] + internal->ageing_M[i - 1];
  }
  for (int i = 1; i <= internal->dim_R; ++i) {
    dstatedt[internal->dim_S + i - 1] = internal->births_deaths_R[i - 1] + internal->ageing_R[i - 1] + internal->gains_immunity[i - 1] - internal->waning_R[i - 1];
  }
  for (int i = 1; i <= internal->dim_S; ++i) {
    dstatedt[0 + i - 1] = internal->births_deaths_S[i - 1] + internal->ageing_S[i - 1] + internal->loses_immunity[i - 1] - internal->infections_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_VD; ++i) {
    dstatedt[internal->offset_variable_VD + i - 1] = internal->births_deaths_VD[i - 1] + internal->ageing_VD[i - 1] - internal->waning_VD[i - 1] - internal->infections_VD[i - 1];
  }
}
void static_model_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  static_model_rhs((static_model_internal*)internal, t, state, dstatedt, NULL);
}
void static_model_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  static_model_rhs(static_model_internal_ds, *t, state, dstatedt, output);
}
SEXP static_model_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  static_model_internal *internal = static_model_get_internal(internal_p, 1);
  double *output = NULL;
  static_model_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max) {
  double ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected a scalar numeric for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      ret = REAL(el)[0];
    } else if (TYPEOF(el) == INTSXP) {
      ret = INTEGER(el)[0];
    } else {
      Rf_error("Expected a numeric value for '%s'", name);
    }
  }
  if (ISNA(ret)) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_double(&ret, 1, min, max, name);
  return ret;
}
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max) {
  int ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar integer for '%d'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      double tmp = REAL(el)[0];
      if (fabs(tmp - round(tmp)) > 2e-8) {
        Rf_error("Expected '%s' to be integer-like", name);
      }
    }
    ret = INTEGER(coerceVector(el, INTSXP))[0];
  }
  if (ret == NA_INTEGER) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_int(&ret, 1, min, max, name);
  return ret;
}
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values(SEXP value, double min, double max,
                           const char *name) {
  size_t len = (size_t)length(value);
  if (TYPEOF(value) == INTSXP) {
    user_check_values_int(INTEGER(value), len, min, max, name);
  } else {
    user_check_values_double(REAL(value), len, min, max, name);
  }
}
SEXP user_list_element(SEXP list, const char *name) {
  SEXP ret = R_NilValue, names = getAttrib(list, R_NamesSymbol);
  for (int i = 0; i < length(list); ++i) {
    if (strcmp(CHAR(STRING_ELT(names, i)), name) == 0) {
      ret = VECTOR_ELT(list, i);
      break;
    }
  }
  return ret;
}
void odin_set_dim(SEXP target, int rank, ...) {
  SEXP r_dim = PROTECT(allocVector(INTSXP, rank));
  int *dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t)rank; ++i) {
    dim[i] = va_arg(ap, int);
  }
  va_end(ap);

  setAttrib(target, R_DimSymbol, r_dim);
  UNPROTECT(1);
}
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  dest_dim[0] = LENGTH(el);
  if (rank > 1) {
    SEXP r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
    int *dim = INTEGER(r_dim);

    for (size_t i = 0; i < (size_t) rank; ++i) {
      dest_dim[i + 1] = dim[i];
    }

    UNPROTECT(1);
  }

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  int len = LENGTH(el);
  void *dest = NULL;
  if (is_integer) {
    dest = R_Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = R_Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  R_Free(previous);

  UNPROTECT(1);

  return dest;
}
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  SEXP r_dim;
  int *dim;

  size_t len = LENGTH(el);
  if (rank == 1) {
    r_dim = PROTECT(ScalarInteger(len));
  } else {
    r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
  }
  dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t) rank; ++i) {
    int dim_expected = va_arg(ap, int);
    if (dim[i] != dim_expected) {
      va_end(ap); // avoid a leak
      if (rank == 1) {
        Rf_error("Expected length %d value for '%s'", dim_expected, name);
      } else {
        Rf_error("Incorrect size of dimension %d of '%s' (expected %d)",
                 i + 1, name, dim_expected);
      }
    }
  }
  va_end(ap);
  UNPROTECT(1);

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  void *dest = NULL;
  if (is_integer) {
    dest = R_Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = R_Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  R_Free(previous);

  UNPROTECT(1);

  return dest;
}
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max) {
  size_t len = (size_t) length(el);
  if (is_integer) {
    if (TYPEOF(el) == INTSXP) {
      user_check_values_int(INTEGER(el), len, min, max, name);
    } else if (TYPEOF(el) == REALSXP) {
      el = PROTECT(coerceVector(el, INTSXP));
      user_check_values_int(INTEGER(el), len, min, max, name);
      UNPROTECT(1);
    } else {
      Rf_error("Expected a integer value for '%s'", name);
    }
  } else {
    if (TYPEOF(el) == INTSXP) {
      el = PROTECT(coerceVector(el, REALSXP));
      user_check_values_double(REAL(el), len, min, max, name);
      UNPROTECT(1);
    } else if (TYPEOF(el) == REALSXP) {
      user_check_values_double(REAL(el), len, min, max, name);
    } else {
      Rf_error("Expected a numeric value for '%s'", name);
    }
  }
  return el;
}
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required) {
  SEXP el = user_list_element(user, name);
  if (el == R_NilValue) {
    if (required) {
      Rf_error("Expected a value for '%s'", name);
    }
  } else {
    if (rank == 1) {
      if (isArray(el)) {
        Rf_error("Expected a numeric vector for '%s'", name);
      }
    } else {
      SEXP r_dim = getAttrib(el, R_DimSymbol);
      if (r_dim == R_NilValue || LENGTH(r_dim) != rank) {
        if (rank == 2) {
          Rf_error("Expected a numeric matrix for '%s'", name);
        } else {
          Rf_error("Expected a numeric array of rank %d for '%s'", rank, name);
        }
      }
    }
  }
  return el;
}
void interpolate_check_y(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target) {
  if (nx != ny) {
    if (i == 0) {
      // vector case
      Rf_error("Expected %s to have length %d (for '%s')",
               name_arg, nx, name_target);
    } else {
      // array case
      Rf_error("Expected dimension %d of %s to have size %d (for '%s')",
               i, name_arg, nx, name_target);
    }
  }
}
double scalar_real(SEXP x, const char * name) {
  if (Rf_length(x) != 1) {
    Rf_error("Expected a scalar for '%s'", name);
  }
  double ret = 0.0;
  if (TYPEOF(x) == INTSXP) {
    ret = INTEGER(x)[0];
  } else if (TYPEOF(x) == REALSXP) {
    ret = REAL(x)[0];
  } else {
    Rf_error("Expected a numeric value for '%s'", name);
  }
  return ret;
}
double odin_sum1(double *x, size_t from, size_t to) {
  double tot = 0.0;
  for (size_t i = from; i < to; ++i) {
    tot += x[i];
  }
  return tot;
}
double odin_sum2(double* x, int from_i, int to_i, int from_j, int to_j, int dim_x_1) {
  double tot = 0.0;
  for (int j = from_j; j < to_j; ++j) {
    int jj = j * dim_x_1;
    for (int i = from_i; i < to_i; ++i) {
      tot += x[i + jj];
    }
  }
  return tot;
}
// This construction is to help odin
#ifndef CINTERPOLTE_CINTERPOLATE_H_
#endif


void * cinterpolate_alloc(const char *type, size_t n, size_t ny,
                          double *x, double *y, bool fail_on_extrapolate,
                          bool auto_clean) {
  typedef void* interpolate_alloc_t(const char *, size_t, size_t,
                                    double*, double*, bool, bool);
  static interpolate_alloc_t *fun;
  if (fun == NULL) {
    fun = (interpolate_alloc_t*)
      R_GetCCallable("cinterpolate", "interpolate_alloc");
  }
  return fun(type, n, ny, x, y, fail_on_extrapolate, auto_clean);
}


int cinterpolate_eval(double x, void *obj, double *y) {
  typedef int interpolate_eval_t(double, void*, double*);
  static interpolate_eval_t *fun;
  if (fun == NULL) {
    fun = (interpolate_eval_t*)
      R_GetCCallable("cinterpolate", "interpolate_eval");
  }
  return fun(x, obj, y);
}


void cinterpolate_free(void *obj) {
  typedef int interpolate_free_t(void*);
  static interpolate_free_t *fun;
  if (fun == NULL) {
    fun = (interpolate_free_t*)
      R_GetCCallable("cinterpolate", "interpolate_free");
  }
  fun(obj);
}
